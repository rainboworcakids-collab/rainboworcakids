<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Lucky Number</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏ò‡∏≤‡∏ï‡∏∏ */
        .number-1 { color: #FF6B6B; font-weight: bold; }
        .number-2 { color: #4ECDC4; font-weight: bold; }
        .number-3 { color: #FFD166; font-weight: bold; }
        .number-4 { color: #06D6A0; font-weight: bold; }
        .number-5 { color: #118AB2; font-weight: bold; }
        .number-6 { color: #073B4C; font-weight: bold; }
        .number-7 { color: #7209B7; font-weight: bold; }
        .number-8 { color: #F72585; font-weight: bold; }
        .number-9 { color: #3A86FF; font-weight: bold; }
        
        .‡∏ó‡∏≠‡∏á‡∏´‡∏¢‡∏¥‡∏ô, .‡∏ó‡∏≠‡∏á‡∏´‡∏¢‡∏≤‡∏á { background: linear-gradient(135deg, #FFF3CD 0%, #FFE69C 100%); border: 2px solid #FFE69C; }
        .‡∏ô‡πâ‡∏≥‡∏´‡∏¢‡∏¥‡∏ô, .‡∏ô‡πâ‡∏≥‡∏´‡∏¢‡∏≤‡∏á { background: linear-gradient(135deg, #D1ECF1 0%, #BEE5EB 100%); border: 2px solid #BEE5EB; }
        .‡πÑ‡∏ü‡∏´‡∏¢‡∏¥‡∏ô, .‡πÑ‡∏ü‡∏´‡∏¢‡∏≤‡∏á { background: linear-gradient(135deg, #F8D7DA 0%, #F5C6CB 100%); border: 2px solid #F5C6CB; }
        .‡πÑ‡∏°‡πâ‡∏´‡∏¢‡∏¥‡∏ô, .‡πÑ‡∏°‡πâ‡∏´‡∏¢‡∏≤‡∏á { background: linear-gradient(135deg, #D4EDDA 0%, #C3E6CB 100%); border: 2px solid #C3E6CB; }
        .‡∏î‡∏¥‡∏ô‡∏´‡∏¢‡∏¥‡∏ô‡∏´‡∏¢‡∏≤‡∏á { background: linear-gradient(135deg, #E2E3E5 0%, #D6D8DB 100%); border: 2px solid #D6D8DB; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4">
    <div id="loading" class="fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto"></div>
            <p class="mt-4 text-lg font-medium">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå...</p>
        </div>
    </div>

    <div id="results-container" class="max-w-6xl mx-auto hidden">
        <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
    </div>

    <div id="error-container" class="max-w-2xl mx-auto bg-red-50 border border-red-200 rounded-lg p-6 hidden">
        <h2 class="text-2xl font-bold text-red-700 mb-4">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h2>
        <p id="error-message" class="text-red-600 mb-4"></p>
        <a href="Lucky_number.html" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
            ‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        </a>
    </div>

    <script src="js/supabase-config.js"></script>
    <script src="js/auth_status_manager.js"></script>
    <script src="js/nav.js"></script>
    
    <script>
    // ==================== GLOBAL VARIABLES ====================
    let globalData = null;
    let selectedCalendarDay = null;

    // ==================== GLOBAL FUNCTIONS ====================
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
    function formatMeaning(text) {
        if (!text) return '';
        return text.replace(/\n/g, '<br>');
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
    function getPersonalDayMeaning(personalDayNumber) {
        // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢
        const meanings = {
            1: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ô‡∏≥",
            2: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡πà‡∏ß‡∏°‡∏°‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô",
            3: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£",
            4: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á",
            5: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á ‡∏≠‡∏¥‡∏™‡∏£‡∏∞",
            6: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß",
            7: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå",
            8: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏á",
            9: "‡∏ß‡∏±‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ"
        };
        return meanings[personalDayNumber] || "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢";
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ò‡∏≤‡∏ï‡∏∏
    function getElementRelation(element1, element2) {
        const elementRelations = {
            '‡∏ó‡∏≠‡∏á‡πÑ‡∏°‡πâ': '‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏°‡∏µ‡∏ä‡∏±‡∏¢',
            '‡∏ô‡πâ‡∏≥‡πÑ‡∏ü': '‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏°‡∏µ‡∏ä‡∏±‡∏¢',
            '‡πÑ‡∏ü‡∏ó‡∏≠‡∏á': '‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏°‡∏µ‡∏ä‡∏±‡∏¢',
            '‡πÑ‡∏°‡πâ‡∏î‡∏¥‡∏ô': '‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏°‡∏µ‡∏ä‡∏±‡∏¢',
            '‡∏î‡∏¥‡∏ô‡∏ô‡πâ‡∏≥': '‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏°‡∏µ‡∏ä‡∏±‡∏¢',
            '‡∏ó‡∏≠‡∏á‡∏î‡∏¥‡∏ô': '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†',
            '‡∏ô‡πâ‡∏≥‡∏ó‡∏≠‡∏á': '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†',
            '‡πÑ‡∏ü‡πÑ‡∏°‡πâ': '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†',
            '‡πÑ‡∏°‡πâ‡∏ô‡πâ‡∏≥': '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†',
            '‡∏î‡∏¥‡∏ô‡πÑ‡∏ü': '‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏†',
            '‡∏ó‡∏≠‡∏á‡∏ó‡∏≠‡∏á': '‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô‡∏™‡∏∏‡∏Ç‡∏™‡∏ö‡∏≤‡∏¢',
            '‡∏ô‡πâ‡∏≥‡∏ô‡πâ‡∏≥': '‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô‡∏™‡∏∏‡∏Ç‡∏™‡∏ö‡∏≤‡∏¢',
            '‡πÑ‡∏ü‡πÑ‡∏ü': '‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô‡∏™‡∏∏‡∏Ç‡∏™‡∏ö‡∏≤‡∏¢',
            '‡πÑ‡∏°‡πâ‡πÑ‡∏°‡πâ': '‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô‡∏™‡∏∏‡∏Ç‡∏™‡∏ö‡∏≤‡∏¢',
            '‡∏î‡∏¥‡∏ô‡∏î‡∏¥‡∏ô': '‡∏Å‡∏•‡∏°‡∏Å‡∏•‡∏∑‡∏ô‡∏™‡∏∏‡∏Ç‡∏™‡∏ö‡∏≤‡∏¢',
            '‡∏ó‡∏≠‡∏á‡∏ô‡πâ‡∏≥': '‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡∏ô‡πâ‡∏≥‡πÑ‡∏°‡πâ': '‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡πÑ‡∏ü‡∏î‡∏¥‡∏ô': '‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡πÑ‡∏°‡πâ‡πÑ‡∏ü': '‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡∏î‡∏¥‡∏ô‡∏ó‡∏≠‡∏á': '‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡∏ó‡∏≠‡∏á‡πÑ‡∏ü': '‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏≠‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡∏ô‡πâ‡∏≥‡∏î‡∏¥‡∏ô': '‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏≠‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡πÑ‡∏ü‡∏ô‡πâ‡∏≥': '‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏≠‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ', 
            '‡πÑ‡∏°‡πâ‡∏ó‡∏≠‡∏á': '‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏≠‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
            '‡∏î‡∏¥‡∏ô‡πÑ‡∏°‡πâ': '‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ‡∏≠‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ',
        };
        
        return elementRelations[`${element2}${element1}`] || '-';
    }

    // ==================== MAIN LOGIC ====================
    document.addEventListener('DOMContentLoaded', async function() {
        try {
            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å sessionStorage
            const storedResult = sessionStorage.getItem('psychomatrixResult');
            
            if (!storedResult) {
                throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà');
            }
            
            const result = JSON.parse(storedResult);
            
            if (!result.success || !result.results) {
                throw new Error(result.error || '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
            }
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
            globalData = result.results;
            
            // ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
            selectedCalendarDay = {
                day: globalData.YDate,
                month: globalData.YMonth,
                year: globalData.YYear,
                personalDayNumber: globalData.PersonalDayNumber,
                luckyNumber: globalData.PersonalDayLucky,
                element: globalData.PersonalDayElement,
                energy: globalData.PersonalDayEnergy,
                relation: globalData.PersonalDayElementRelation
            };

            // ‡∏ã‡πà‡∏≠‡∏ô loading
            document.getElementById('loading').style.display = 'none';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            renderResults(globalData);
            
        } catch (error) {
            console.error('Error:', error);
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error-message').textContent = error.message;
            document.getElementById('error-container').classList.remove('hidden');
        }
    });

    // ==================== RENDER FUNCTIONS ====================
 
    function renderResults(data) {
        const container = document.getElementById('results-container');
        
        let html = `
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="text-center mb-6">
                    <h1 class="text-3xl font-bold text-purple-700 mb-2">
                        üîÆ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Lucky Number
                    </h1>
                    <p class="text-gray-600">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleString('th-TH')}</p>
                </div>
                
                <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="text-lg font-bold text-blue-700 mb-3">üìÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>
                        <p><strong>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ:</strong> ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î (Birth Date)</p>
                        <p><strong>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î:</strong> ${data.UDate}/${data.UMonth}/${data.UYear}</p>
                        <p><strong>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î:</strong> ${data.Ubirth_time}</p>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700 mb-3">üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</h3>
                        <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö:</strong> ${data.YDate}/${data.YMonth}/${data.YYear}</p>
                        <p><strong>‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢:</strong> ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ-‡∏õ‡∏µ‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£</p>
                    </div>
                </div>
                
                <!-- ‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg mb-8 border-l-4 border-purple-500">
                    <h2 class="text-2xl font-bold text-purple-800 mb-4 flex items-center">
                        <span class="mr-2">üåü</span> ‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï (Life Path Number)
                    </h2>
                    
                    <div class="flex flex-wrap items-center gap-4 mb-4">
                        <div class="text-center">
                            <span class="text-6xl font-bold number-${data.LifePathNumber}">
                                ${data.LifePathNumber}
                            </span>
                            <p class="text-sm text-gray-600">‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</p>
                        </div>
                        
                        <div class="text-center">
                            <div class="px-4 py-2 rounded-lg ${data.LifePathElement}${data.LifePathEnergy}">
                                <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${data.LifePathElement}</span>
                                <br>
                                <span class="text-sm">${data.LifePathEnergy}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h3 class="text-lg font-bold text-gray-700 mb-2">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:</h3>
                        <p class="text-gray-700">${formatMeaning(data.RootNumberMeaning)}</p>
                    </div>
                </div>
                
                <!-- ‡πÄ‡∏•‡∏Ç‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg mb-8 border-l-4 border-blue-500">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4 flex items-center">
                        <span class="mr-2">üí´</span> ‡πÄ‡∏•‡∏Ç‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤ (Destiny Number)
                    </h2>
                    
                    <div class="mb-4">
                        <span class="text-5xl font-bold number-${data.LifePathNumber}">
                            ${data.DestinyNumber}
                        </span>
                    </div>
                    
                    <div class="mt-4">
                        <h3 class="text-lg font-bold text-gray-700 mb-2">‡∏û‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à:</h3>
                        <p class="text-gray-700">${formatMeaning(data.DestinyNumberMeaning)}</p>
                    </div>
                </div>
        `;
        
        if (data.Prophesy === "1") {
            // ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
            html += `
                <div class="bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-lg mb-8 border-l-4 border-green-500">
                    <h2 class="text-2xl font-bold text-green-800 mb-4 flex items-center">
                        <span class="mr-2">üçÄ</span> ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î
                    </h2>
                    
                    <div class="mb-4">
                        <span class="text-4xl font-bold text-green-600">
                            ${data.LifePathLucky}
                        </span>
                    </div>
                </div>
            `;
            
            // ‡∏õ‡∏µ‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
            html += renderPersonalYearSection(data);
            
            // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
            html += renderPersonalMonthSection(data);
            
            // ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
            html += renderMonthCalendar(data);
            
            // ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á Personal Day
            html += `
                <div id="PersonalDayNumber" class="bg-gradient-to-r from-pink-50 to-rose-50 p-6 rounded-lg mb-8 border-l-4 border-pink-500">
                    <div id="headPersonalDayNumber">
                        <h2 class="text-2xl font-bold text-pink-800 mb-4 flex items-center">
                            <span class="mr-2">üìÖ</span> ‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£ (Personal Day Number): 
                            ${data.YDate}/${data.YMonth}/${data.YYear}
                        </h2>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div id="mainPersonalDayNumber">
                            <div class="flex flex-wrap items-center gap-4 mb-3">
                                <span class="text-4xl font-bold number-${data.PersonalDayNumber}">
                                    ${data.PersonalDayNumber}
                                </span>
                                <div class="px-4 py-2 rounded-lg ${data.PersonalDayElement}${data.PersonalDayEnergy}">
                                    <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${data.PersonalDayElement}</span>
                                    <br>
                                    <span class="text-sm">${data.PersonalDayEnergy}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div id="personalDayRelation" class="mt-3">
                            <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</strong> ${data.PersonalDayElementRelation}</p>
                        </div>
                        
                        <div id="sectionLuckyNum" class="mt-4">
                            <p class="text-2xl mb-2 font-bold" style="color: #606060;">
                                <strong>‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô :</strong> 
                                <span class="text-4xl p-2 number-${data.PersonalDayNumber}">
                                    ${data.PersonalDayLucky}
                                </span>
                            </p>
                        </div>
                        
                        <div id="sectionLuckyNum1" class="mt-2 text-sm">
                            <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏î‡∏¢ updatePersonalDaySection -->
                        </div>
                        
                        <div id="personalDayMeaning" class="mt-4">
                            <h3 class="text-lg font-bold text-gray-700 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£:</h3>
                            <p class="text-gray-700">${getPersonalDayMeaning(data.PersonalDayNumber)}</p>
                        </div>
                        
                        <div id="gregorianDateInfo" class="mt-4">
                            <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏î‡∏¢ updatePersonalDaySection -->
                        </div>
                    </div>
                </div>
            `;
            
        } else if (data.Prophesy === "2") {
            // ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
            html += renderRelationshipAnalysis(data);
        }
        
        html += `
                <div class="mt-8 pt-6 border-t border-gray-200">
                    <a href="Lucky_number.html" 
                       class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-lg hover:opacity-90 transition-all">
                       ‚Üê ‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                    </a>
                    <button onclick="window.print()" 
                            class="ml-4 bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300">
                        üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                    </button>
                </div>
            </div>
        `;
        
        container.innerHTML = html;
        container.classList.remove('hidden');
        
        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Personal Day Section ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        updatePersonalDaySection(selectedCalendarDay);
    }   
    
    function renderPersonalYearSection(data) {
        let html = `
            <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-lg mb-8 border-l-4 border-yellow-500">
                <h2 class="text-2xl font-bold text-yellow-800 mb-4 flex items-center">
                    <span class="mr-2">üìÖ</span> ‡∏õ‡∏µ‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£ (Personal Year Number)
                </h2>
        `;
        
        if (data.IsBeforeBirthday && data.PersonalYearNumberPrev) {
            html += `
                <div class="mb-6 p-4 bg-white rounded-lg">
                    <h3 class="text-lg font-bold text-blue-700 mb-2">‡∏ä‡πà‡∏ß‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</h3>
                    <div class="flex flex-wrap items-center gap-4 mb-3">
                        <span class="text-4xl font-bold number-${data.PersonalYearNumberPrev}">
                            ${data.PersonalYearNumberPrev}
                        </span>
                        <div class="px-4 py-2 rounded-lg ${data.PersonalYearPrevElement}${data.PersonalYearPrevEnergy}">
                            <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${data.PersonalYearPrevElement}</span>
                            <br>
                            <span class="text-sm">${data.PersonalYearPrevEnergy}</span>
                        </div>
                    </div>
                    <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</strong> ${data.PersonalYearPrevElementRelation}</p>
                    <p class="mt-2"><strong>‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ:</strong> 
                        <span class="text-2xl text-green-600 font-bold">${data.PersonalYearPrevLucky}</span>
                    </p>
                </div>
                
                <div class="p-4 bg-white rounded-lg">
                    <h3 class="text-lg font-bold text-green-700 mb-2">‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</h3>
            `;
        }
        
        html += `
                    <div class="flex flex-wrap items-center gap-4 mb-3">
                        <span class="text-4xl font-bold number-${data.PersonalYearNumber}">
                            ${data.PersonalYearNumber}
                        </span>
                        <div class="px-4 py-2 rounded-lg ${data.PersonalYearElement}${data.PersonalYearEnergy}">
                            <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${data.PersonalYearElement}</span>
                            <br>
                            <span class="text-sm">${data.PersonalYearEnergy}</span>
                        </div>
                    </div>
                    <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</strong> ${data.PersonalYearElementRelation}</p>
                    <p class="mt-2"><strong>‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ:</strong> 
                        <span class="text-2xl text-green-600 font-bold">${data.PersonalYearLucky}</span>
                    </p>
                </div>
            </div>
        `;
        
        return html;
    }
    
    function renderPersonalMonthSection(data) {
        return `
            <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-lg mb-8 border-l-4 border-indigo-500">
                <h2 class="text-2xl font-bold text-indigo-800 mb-4 flex items-center">
                    <span class="mr-2">üìÜ</span> ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£ (Personal Month Number)
                </h2>
                
                <div class="flex flex-wrap items-center gap-4 mb-3">
                    <span class="text-4xl font-bold number-${data.PersonalMonthNumber}">
                        ${data.PersonalMonthNumber}
                    </span>
                    <div class="px-4 py-2 rounded-lg ${data.PersonalMonthElement}${data.PersonalMonthEnergy}">
                        <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${data.PersonalMonthElement}</span>
                        <br>
                        <span class="text-sm">${data.PersonalMonthEnergy}</span>
                    </div>
                </div>
                
                <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</strong> ${data.PersonalMonthElementRelation}</p>
                <p class="mt-2"><strong>‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</strong> 
                    <span class="text-2xl text-green-600 font-bold">${data.PersonalMonthLucky}</span>
                </p>
            </div>
        `;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Edge Function
    function renderMonthCalendar(data) {
        const calendar = data.MonthCalendar;
        const currentDay = parseInt(data.YDate) || 1;
        const currentMonth = parseInt(data.YMonth);
        const currentYear = parseInt(data.YYear);
        
        let html = `
            <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-lg mb-8 border-l-4 border-indigo-500">
                <h2 class="text-2xl font-bold text-indigo-800 mb-4 flex items-center">
                    <span class="mr-2">üìÜ</span> ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£ ${calendar.monthName} ${calendar.year}
                </h2>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-indigo-100">
                                <th class="p-3 border text-center">‡∏≠‡∏≤</th>
                                <th class="p-3 border text-center">‡∏à</th>
                                <th class="p-3 border text-center">‡∏≠</th>
                                <th class="p-3 border text-center">‡∏û</th>
                                <th class="p-3 border text-center">‡∏û‡∏§</th>
                                <th class="p-3 border text-center">‡∏®</th>
                                <th class="p-3 border text-center">‡∏™</th>
                            </tr>
                        </thead>
                        <tbody>
        `;
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô 6 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
        let dayCounter = 0;
        let isFirstWeek = true;
        
        for (let week = 0; week < 6; week++) {
            html += '<tr>';
            
            for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
                // ‡∏ñ‡πâ‡∏≤‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                if (isFirstWeek && dayOfWeek < calendar.firstDayOfWeek) {
                    html += '<td class="p-3 border bg-gray-50"></td>';
                    continue;
                }
                
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                if (dayCounter >= calendar.days.length) {
                    html += '<td class="p-3 border bg-gray-50"></td>';
                    continue;
                }
                
                const dayData = calendar.days[dayCounter];
                
                // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                const isCurrentDay = (
                    dayData.day === currentDay && 
                    calendar.month === currentMonth && 
                    calendar.year === currentYear
                );
                
                // ‚úÖ ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå
                const highlightClass = isCurrentDay ? 'bg-yellow-100 border-2 border-yellow-400' : '';
                const dayClass = `calendar-day ${highlightClass} transition-all hover:bg-blue-50 cursor-pointer`;
                
                html += `
                    <td class="p-2 border text-center ${dayClass}" 
                        data-day="${dayData.day}"
                        data-month="${calendar.month}"
                        data-year="${calendar.year}"
                        data-personal-day="${dayData.personalDayNumber}"
                        data-lucky-number="${dayData.personalDayLucky}"
                        data-element="${dayData.element}"
                        data-energy="${dayData.energy}"
                        data-relation="${dayData.elementRelation}"
                        onclick="handleCalendarDayClick(this)">
                    <div class="font-bold ${isCurrentDay ? 'text-red-600' : ''}">${dayData.day}</div>
                    <div class="text-xs mt-1">
                        <span class="number-${dayData.personalDayNumber}">${dayData.personalDayNumber}</span>,
                        <span class="text-green-600">${dayData.personalDayLucky}</span>
                    </div>
                    <div class="text-xs text-gray-500 mt-1">${dayData.dayName}</div>
                    </td>
                `;
                
                dayCounter++;
            }
            
            html += '</tr>';
            isFirstWeek = false;
            
            // ‡∏´‡∏¢‡∏∏‡∏î‡∏ñ‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß
            if (dayCounter >= calendar.days.length) break;
        }
        
        html += `
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold text-blue-700 mb-2">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô:</h4>
                        <p>${data.YDate}/${data.YMonth}/${data.YYear}</p>
                        <p class="text-sm text-gray-600">(‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö)</p>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-bold text-green-700 mb-2">üîÑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</h4>
                        <p class="text-sm">
                            <strong>‡∏õ‡∏µ‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£:</strong> ${data.PersonalYearRelationText || '-'}<br>
                            <strong>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£:</strong> ${data.PersonalMonthRelationText || '-'}<br>
                            <strong>‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£:</strong> ${data.PersonalDayRelationText || '-'}
                        </p>
                    </div>
                </div>
                
                <div class="mt-4 text-sm text-gray-600">
                    <p>üìå <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£</p>
                    <p>üåü <strong>‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á:</strong> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                    <p>üî¢ <strong>‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç:</strong> Personal Day Number, ‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</p>
                </div>
            </div>
        `;
        
        return html;
    }

    function handleCalendarDayClick(cellElement) {
        // ‚úÖ 1. ‡∏•‡∏ö‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÄ‡∏ã‡∏•‡∏•‡πå
        document.querySelectorAll('.calendar-day').forEach(cell => {
            cell.classList.remove('bg-yellow-100', 'border-2', 'border-yellow-400');
            cell.classList.add('border');
        });
        
        // ‚úÖ 2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡∏¥‡∏Å
        cellElement.classList.remove('border');
        cellElement.classList.add('bg-yellow-100', 'border-2', 'border-yellow-400');
        
        // ‚úÖ 3. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        selectedCalendarDay = {
            day: cellElement.dataset.day,
            month: cellElement.dataset.month,
            year: cellElement.dataset.year,
            personalDayNumber: cellElement.dataset.personalDay,
            luckyNumber: cellElement.dataset.luckyNumber,
            element: cellElement.dataset.element,
            energy: cellElement.dataset.energy,
            relation: cellElement.dataset.relation
        };
        
        // ‚úÖ 4. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
        updatePersonalDaySection(selectedCalendarDay);
    }

    function updatePersonalDaySection(dayData) {
        if (!dayData || !globalData) return;
        
        const lifePathElement = globalData.LifePathElement;
        const lifePathNumber = globalData.LifePathNumber;
        
        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠
        document.getElementById('headPersonalDayNumber').innerHTML = `
            <h2 class="text-2xl font-bold text-pink-800 mb-4 flex items-center">
                <span class="mr-2">üìÖ</span> ‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£ (Personal Day Number): 
                ${dayData.day}/${dayData.month}/${dayData.year}
            </h2>
        `;
        
        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å
        document.getElementById('mainPersonalDayNumber').innerHTML = `
            <div class="flex flex-wrap items-center gap-4 mb-3">
                <span class="text-4xl font-bold number-${dayData.personalDayNumber}">
                    ${dayData.personalDayNumber}
                </span>
                <div class="px-4 py-2 rounded-lg ${dayData.element}${dayData.energy}">
                    <span class="font-bold">‡∏ò‡∏≤‡∏ï‡∏∏${dayData.element}</span>
                    <br>
                    <span class="text-sm">${dayData.energy}</span>
                </div>
            </div>
        `;
        
        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
        document.getElementById('personalDayRelation').innerHTML = `
            <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå:</strong> ${dayData.relation}</p>
            <p class="text-sm text-gray-600">
                ‡∏ò‡∏≤‡∏ï‡∏∏${dayData.element}${dayData.energy} ${dayData.relation} 
                ‡∏ò‡∏≤‡∏ï‡∏∏${lifePathElement}‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï
            </p>
        `;
        
        // ‚úÖ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ
        document.getElementById('sectionLuckyNum').innerHTML = `
            <p class='text-2xl mb-2 font-bold' style='color: #606060;'>
                <strong>‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô :</strong> 
                <span class="text-4xl p-2 number-${dayData.personalDayNumber}">
                    ${dayData.luckyNumber}
                </span>
            </p>
        `;
        
        // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏û‡∏•‡∏±‡∏á
        const lifePathLucky = (globalData.LifePathLucky || '').split(',');
        const dayLuckyNumbers = dayData.luckyNumber.split(',');
        const isSupportive = dayLuckyNumbers.some(num => lifePathLucky.includes(num.trim()));
        
        document.getElementById('sectionLuckyNum1').innerHTML = isSupportive ? 
            "<p style='color:#10F010'>*‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î</p>" : 
            "-‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏•‡∏Ç‡∏ô‡∏≥‡πÇ‡∏ä‡∏Ñ‡∏ß‡∏±‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î";
        
        // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£
        const dayMeaning = getPersonalDayMeaning(parseInt(dayData.personalDayNumber));
        document.getElementById('personalDayMeaning').innerHTML = `
            <h3 class="text-lg font-bold text-gray-700 mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£:</h3>
            <p class="text-gray-700">${formatMeaning(dayMeaning)}</p>
        `;
        
        // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
        const dateObj = new Date(dayData.year, dayData.month - 1, dayData.day);
        const dayNames = ["‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå", "‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "‡∏û‡∏∏‡∏ò", "‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡πÄ‡∏™‡∏≤‡∏£‡πå"];
        const monthNames = [
            "‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô",
            "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"
        ];
        
        document.getElementById('gregorianDateInfo').innerHTML = `
            <div class="bg-gray-50 p-3 rounded-lg mt-4">
                <p><strong>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≤‡∏°‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô:</strong> ${dayData.day}/${dayData.month}/${dayData.year}</p>
                <p><strong>üìÜ ‡∏ß‡∏±‡∏ô:</strong> ‡∏ß‡∏±‡∏ô${dayNames[dateObj.getDay()]} ‡∏ó‡∏µ‡πà ${dayData.day} ${monthNames[dateObj.getMonth()]} ‡∏û.‡∏®. ${parseInt(dayData.year) + 543}</p>
            </div>
        `;
    }
    
    function renderRelationshipAnalysis(data) {
        return `
            <div class="bg-gradient-to-r from-teal-50 to-cyan-50 p-6 rounded-lg mb-8 border-l-4 border-teal-500">
                <h2 class="text-2xl font-bold text-teal-800 mb-4 flex items-center">
                    <span class="mr-2">üíë</span> ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-white p-4 rounded-lg">
                        <h3 class="text-lg font-bold text-blue-700 mb-2">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà 1</h3>
                        <p><strong>‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï:</strong> 
                            <span class="text-3xl number-${data.LifePathNumber}">${data.LifePathNumber}</span>
                        </p>
                        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏:</strong> ${data.LifePathElement} (${data.LifePathEnergy})</p>
                    </div>
                    
                    <div class="bg-white p-4 rounded-lg">
                        <h3 class="text-lg font-bold text-green-700 mb-2">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà 2</h3>
                        <p><strong>‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï:</strong> 
                            <span class="text-3xl number-${data.RootNumberCompare}">${data.RootNumberCompare}</span>
                        </p>
                        <p><strong>‡∏ò‡∏≤‡∏ï‡∏∏:</strong> ${data.CompareElement} (${data.CompareEnergy})</p>
                    </div>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="text-lg font-bold text-purple-700 mb-2">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
                    <p><strong>‡∏ú‡∏•‡∏£‡∏ß‡∏°‡πÄ‡∏•‡∏Ç‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï:</strong> ${data.SumNum}</p>
                    <p><strong>‡πÄ‡∏•‡∏Ç Math:</strong> ${data.MathNum}</p>
                    <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏ò‡∏≤‡∏ï‡∏∏:</strong> ${data.CompareElementRelation}</p>
                    <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:</strong> ${formatMeaning(data.RootNumberCompareMeaning)}</p>
                </div>
            </div>
        `;
    }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychomatrix Analysis - Event Log Version</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Supabase JS Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/PsychomatrixStyle.css">
    
    <!-- Favicon -->
    <link rel="icon" href="images/PsychomatixAnalize.png" type="image/png">
    
    <!-- Scripts ‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö -->
    <script src="js/supabase-config.js"></script>
    <script src="js/debug-logger.js"></script>
    <script src="js/auth_status_manager.js"></script>
    <script src="js/nav.js"></script>
    
    <!-- VERSION INDICATOR -->
    <script>
        const RESULT_PAGE_VERSION = "2.0.2-EVENT-LOGGING";
    </script>
</head>
<body class="tw-bg-gray-100 tw-p-4">
    <!-- Navigation Bar -->
    <div id="nav-container"></div>

    <!-- VERSION DISPLAY -->
    <div class="tw-fixed tw-bottom-4 tw-right-4 tw-bg-gray-800 tw-text-white tw-px-3 tw-py-1 tw-rounded tw-text-xs tw-opacity-75 tw-z-50">
        Version: <span id="version-display">2.0.2</span>
    </div>

    <div class="tw-max-w-4xl tw-mx-auto tw-mt-6">
        <!-- TABS -->
        <div class="tw-flex tw-border-b tw-border-gray-300">
            <button class="tablink active" onclick="switchTab('Main', this)">Main</button>
            <button class="tablink" onclick="switchTab('Explained', this)">Explained</button>
        </div>

        <!-- MAIN TAB -->
        <div id="Main" class="tabcontent active tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-4">
            <h1 class="tw-text-3xl tw-font-bold tw-text-center tw-mb-6">
                <img src="https://rainboworcakids-collab.github.io/rainboworcakids/images/PsychomatixAnalize.png" 
                     alt="Logo" class="tw-h-16 tw-w-16 tw-inline tw-mr-3">
                Psychomatrix Analysis - Event Log
            </h1>
            
            <!-- EVENT LOG PANEL -->
            <div id="event-log-panel" class="tw-bg-blue-50 tw-border tw-border-blue-300 tw-p-4 tw-rounded tw-mb-6" style="display: block;">
                <div class="tw-font-bold tw-mb-3 tw-text-blue-800 tw-flex tw-items-center">
                    <i class="fas fa-history tw-mr-2"></i>üìã EVENT LOG
                </div>
                <div id="event-log-content" class="tw-font-mono tw-text-xs tw-space-y-1 tw-max-h-60 tw-overflow-y-auto tw-bg-white tw-p-3 tw-rounded tw-border"></div>
            </div>

            <!-- LOADING STATE -->
            <div id="loading-state" class="tw-text-center tw-py-8">
                <div class="tw-animate-pulse tw-text-gray-600">
                    <i class="fas fa-spinner tw-spin tw-mr-2"></i>
                    <span id="loading-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...</span>
                </div>
                <div id="loading-details" class="tw-text-xs tw-text-gray-400 tw-mt-2 tw-font-mono"></div>
            </div>

            <!-- RESULT CONTENT -->
            <div id="result-content" style="display: none;">
                <!-- Content will be rendered here -->
            </div>
        </div>

        <!-- EXPLAINED TAB -->
        <div id="Explained" class="tabcontent tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-4">
            <div id="explained-content">
                <p class="tw-text-gray-500 tw-text-center tw-py-8">
                    <i class="fas fa-hand-pointer tw-mr-2"></i>
                    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                </p>
            </div>
        </div>
    </div>

    <script>
        // ==================== EVENT LOGGING SYSTEM ====================
        const RESULT_PAGE_VERSION = "2.0.2-EVENT-LOGGING";
        const eventLog = [];

        const logEvent = (step, message, data = null, type = 'info') => {
            const timestamp = new Date().toLocaleTimeString('th-TH', { hour12: false });
            const icon = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : 'üîç';
            const color = type === 'error' ? 'text-red-600' : type === 'success' ? 'text-green-600' : 'text-blue-600';
            
            const logEntry = {
                timestamp,
                step,
                message,
                data,
                type
            };
            
            eventLog.push(logEntry);
            
            // Display in UI
            const logContent = document.getElementById('event-log-content');
            const dataStr = data ? `<pre class="tw-text-gray-500 tw-whitespace-pre-wrap">${JSON.stringify(data, null, 2)}</pre>` : '';
            logContent.innerHTML += `<div class="${color} tw-mb-2"><strong>${icon} [${timestamp}] ${step}:</strong> ${message}${dataStr}</div>`;
            logContent.scrollTop = logContent.scrollHeight;
            
            // Log to console
            console.log(`[${type.toUpperCase()}] ${step}: ${message}`, data || '');
        };

        // ==================== TAB SYSTEM ====================
        function switchTab(tabName, el) {
            document.querySelectorAll('.tabcontent').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tablink').forEach(link => link.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            el.classList.add('active');
        }

        // ==================== STEP 1: GET URL PARAMETERS ====================
        function getDataFromURL() {
            logEvent('URL_PARSER', '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å URL parameters');
            
            const params = new URLSearchParams(window.location.search);
            const data = {
                birth_date: params.get('bd') || "",
                birth_numbers: params.get('bn') || "",
                birth_day: params.get('day') || "",
                birth_month: params.get('month') || "",
                birth_year: params.get('year') || "",
                destiny_number: parseInt(params.get('destiny') || "0"),
                life_path_number: parseInt(params.get('lifepath') || "0"),
                id_card: params.get('idc') || "",
                full_name: params.get('name') || "",
                option: params.get('opt') || "BD"
            };
            
            logEvent('URL_PARSER', '‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', data);
            
            // Validation
            if (!data.birth_date) {
                logEvent('VALIDATION', '‚ö†Ô∏è ‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ birth_date ‡πÉ‡∏ô URL', null, 'warning');
            }
            if (!data.destiny_number) {
                logEvent('VALIDATION', '‚ö†Ô∏è ‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ destiny_number ‡πÉ‡∏ô URL', null, 'warning');
            }
            if (!data.life_path_number) {
                logEvent('VALIDATION', '‚ö†Ô∏è ‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ life_path_number ‡πÉ‡∏ô URL', null, 'warning');
            }
            
            return data;
        }

        // ==================== STEP 2: PREPARE SUPABASE QUERY ====================
        async function fetchLifePathFromSupabase(rootNumber) {
            logEvent('SUPABASE_QUERY', `‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô query LifePath ${rootNumber} ‡∏à‡∏≤‡∏Å Supabase`);
            
            if (!rootNumber || rootNumber < 1 || rootNumber > 9) {
                const errorMsg = `Invalid LifePath number: ${rootNumber}`;
                logEvent('SUPABASE_QUERY', `‚ùå ${errorMsg}`, null, 'error');
                return { success: false, error: errorMsg, summary: "‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á" };
            }

            try {
                // Build query
                const queryParams = [
                    `element_type=eq.LifePath`,
                    `root_number=eq.${rootNumber}`,
                    `select=*`
                ].join('&');
                
                const url = `${window.SUPABASE_URL}/rest/v1/numerology_search_index?${queryParams}`;
                logEvent('SUPABASE_QUERY', `SQL Query URL: ${url}`);
                logEvent('SUPABASE_QUERY', `SQL Command: SELECT * FROM numerology_search_index WHERE element_type='LifePath' AND root_number=${rootNumber}`);
                
                // Show HTTP request details
                const headers = {
                    'apikey': window.SUPABASE_ANON_KEY,
                    'Authorization': `Bearer ${window.SUPABASE_ANON_KEY}`
                };
                logEvent('SUPABASE_QUERY', `HTTP Headers (API Key shown partially): ${JSON.stringify({ ...headers, apikey: headers.apikey.substring(0, 10) + '...' })}`);

                updateLoadingStatus(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á request ‡πÑ‡∏õ Supabase...`);

                const response = await fetch(url, { headers });

                // Log HTTP response
                logEvent('SUPABASE_RESPONSE', `HTTP Status: ${response.status} ${response.statusText}`);
                logEvent('SUPABASE_RESPONSE', `HTTP Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()))}`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status} - ${response.statusText}`);
                }

                const data = await response.json();
                logEvent('SUPABASE_RESPONSE', `Raw Response Data:`, data);

                if (data && data.length > 0 && data[0]) {
                    const row = data[0];
                    logEvent('SUPABASE_SUCCESS', `‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LifePath`, {
                        id: row.id,
                        title: row.title,
                        summary_preview: row.summary ? row.summary.substring(0, 100) + '...' : 'No summary'
                    });
                    
                    return {
                        success: true,
                        id: row.id,
                        title: row.title,
                        summary: row.summary || "‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö",
                        html_path: row.html_path
                    };
                }

                logEvent('SUPABASE_NOT_FOUND', '‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Supabase ‡∏à‡∏∞‡πÉ‡∏ä‡πâ GitHub fallback', null, 'warning');
                return {
                    success: false,
                    summary: "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å GitHub...",
                    html_path: `/PsychomatrixContents/LifePathNumber${rootNumber}.html`
                };

            } catch (error) {
                logEvent('SUPABASE_ERROR', `‚ùå Error: ${error.message}`, { error: error.toString() }, 'error');
                return {
                    success: false,
                    summary: `‚ùå Error: ${error.message} ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ GitHub fallback...`,
                    html_path: `/PsychomatrixContents/LifePathNumber${rootNumber}.html`
                };
            }
        }

        // ==================== STEP 3: GITHUB FALLBACK ====================
        async function fetchGitHubContent(path) {
            logEvent('GITHUB_LOAD', `‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å GitHub: ${path}`);
            
            try {
                const url = `https://rainboworcakids-collab.github.io/rainboworcakids${path}`;
                logEvent('GITHUB_LOAD', `Full GitHub URL: ${url}`);
                
                const response = await fetch(url);
                logEvent('GITHUB_RESPONSE', `HTTP Status: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    throw new Error(`GitHub HTTP ${response.status}`);
                }
                
                const content = await response.text();
                logEvent('GITHUB_SUCCESS', `‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${content.length} characters`);
                
                return content;
            } catch (error) {
                logEvent('GITHUB_ERROR', `‚ùå ${error.message}`, null, 'error');
                return `<div class="tw-text-red-500 tw-p-4"><p>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏î‡πâ</p><p class="tw-text-xs">${error.message}</p></div>`;
            }
        }

        // ==================== RENDERING ====================
        function renderNumerologyTable(data) {
            logEvent('RENDER_TABLE', '‡πÄ‡∏£‡∏¥‡πà‡∏° render Numerology Table');
            
            if (!data.destiny_number || !data.life_path_number) {
                logEvent('RENDER_TABLE', '‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ render ‡πÑ‡∏î‡πâ: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', data, 'error');
                return '<div class="tw-text-red-500 tw-text-center tw-p-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÑ‡∏î‡πâ</div>';
            }

            const destinyLink = `/PsychomatrixContents/Destiny${data.destiny_number}.html`;
            const lifePathLink = `/PsychomatrixContents/LifePathNumber${data.life_path_number}.html`;

            const html = `
                <div class="tw-overflow-x-auto tw-my-6">
                    <table class="tw-w-full tw-border-collapse tw-border tw-border-gray-300">
                        <thead>
                            <tr class="tw-bg-gray-100">
                                <th class="tw-border tw-border-gray-300 tw-p-3">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</th>
                                <th class="tw-border tw-border-gray-300 tw-p-3">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</th>
                                <th class="tw-border tw-border-gray-300 tw-p-3">‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î</th>
                                <th class="tw-border tw-border-gray-300 tw-p-3">‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤</th>
                                <th class="tw-border tw-border-gray-300 tw-p-3">‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="tw-border tw-border-gray-300 tw-p-3">${data.birth_day || '-'}</td>
                                <td class="tw-border tw-border-gray-300 tw-p-3">${data.birth_month || '-'}</td>
                                <td class="tw-border tw-border-gray-300 tw-p-3">${data.birth_year || '-'}</td>
                                <td class="tw-border tw-border-gray-300 tw-p-3 tw-bg-blue-50">
                                    <a href="#" class="tw-font-bold tw-text-blue-600 numerology-link" 
                                       data-href="${destinyLink}" data-tab="Explained">${data.destiny_number}</a>
                                </td>
                                <td class="tw-border tw-border-gray-300 tw-p-3 tw-bg-green-50">
                                    <a href="#" class="tw-font-bold tw-text-green-600 numerology-link" 
                                       data-href="${lifePathLink}" data-tab="Explained">${data.life_path_number}</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            logEvent('RENDER_TABLE', '‚úÖ Render ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', { destiny: data.destiny_number, lifepath: data.life_path_number });
            return html;
        }

        function renderResult(data, lifePathData) {
            logEvent('RENDER_PAGE', '‡πÄ‡∏£‡∏¥‡πà‡∏° render ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å');
            
            return `
                <div class="tw-mb-6">
                    <h2 class="tw-text-2xl tw-font-bold tw-mb-4">‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î: ${data.birth_date}</h2>
                    
                    <div class="tw-grid md:tw-grid-cols-2 tw-gap-6 tw-mb-6">
                        <div class="tw-bg-blue-50 tw-p-4 tw-rounded">
                            <h3 class="tw-text-lg tw-font-semibold tw-text-blue-800">‡πÄ‡∏•‡∏Ç‡∏†‡∏≤‡∏£‡∏∞‡∏Å‡∏¥‡∏à</h3>
                            <p class="tw-text-3xl tw-font-bold tw-text-blue-600">${data.destiny_number}</p>
                        </div>
                        <div class="tw-bg-green-50 tw-p-4 tw-rounded">
                            <h3 class="tw-text-lg tw-font-semibold tw-text-green-800">‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</h3>
                            <p class="tw-text-3xl tw-font-bold tw-text-green-600">${data.life_path_number}</p>
                        </div>
                    </div>

                    <div class="tw-bg-gray-50 tw-p-4 tw-rounded tw-mb-6">
                        <h3 class="tw-font-semibold tw-mb-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï:</h3>
                        <p class="tw-text-gray-700">${lifePathData.summary}</p>
                        ${lifePathData.success ? 
                            `<div class="tw-text-xs tw-text-green-600 tw-mt-2">‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Supabase</div>` :
                            `<div class="tw-text-xs tw-text-yellow-600 tw-mt-2">‚ö†Ô∏è ‡πÉ‡∏ä‡πâ GitHub fallback</div>`
                        }
                    </div>

                    ${renderNumerologyTable(data)}
                </div>
            `;
        }

        // ==================== MAIN EXECUTION ====================
        async function initializePage() {
            logEvent('PAGE_INIT', '=== PAGE INITIALIZATION STARTED ===');
            logEvent('PAGE_INIT', `Version: ${RESULT_PAGE_VERSION}`);
            logEvent('PAGE_INIT', `Page URL: ${window.location.href}`);
            
            // Display version
            document.getElementById('version-display').textContent = RESULT_PAGE_VERSION;
            
            updateLoadingStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å URL parameters...');
            
            // Get URL data
            const data = getDataFromURL();
            logEvent('PAGE_INIT', `Data extraction complete`, data);
            
            // Validate
            if (!data.birth_date || !data.destiny_number || !data.life_path_number) {
                const errorMsg = `Missing required data: birth_date=${data.birth_date}, destiny=${data.destiny_number}, lifepath=${data.life_path_number}`;
                logEvent('VALIDATION', `‚ùå ${errorMsg}`, null, 'error');
                throw new Error(errorMsg);
            }
            
            logEvent('VALIDATION', '‚úÖ All required data present');
            
            // Fetch from Supabase
            updateLoadingStatus(`‡∏Å‡∏≥‡∏•‡∏±‡∏á query Supabase ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö LifePath ${data.life_path_number}...`);
            const lifePathData = await fetchLifePathFromSupabase(data.life_path_number);
            
            // Render
            updateLoadingStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á render ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤...');
            document.getElementById('result-content').innerHTML = renderResult(data, lifePathData);
            document.getElementById('loading-state').style.display = 'none';
            document.getElementById('result-content').style.display = 'block';
            
            logEvent('PAGE_INIT', '=== PAGE INITIALIZATION COMPLETE ===');
        }

        // ==================== EVENT LISTENERS ====================
        document.addEventListener('DOMContentLoaded', () => {
            logEvent('DOM_READY', 'DOM Content Loaded - Starting page initialization');
            initializePage();
        });

        // Link click handler
        document.addEventListener('click', async (e) => {
            const link = e.target.closest('.numerology-link');
            if (link) {
                e.preventDefault();
                const href = link.dataset.href;
                logEvent('LINK_CLICK', `User clicked link: ${href}`);
                
                updateLoadingStatus(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤: ${href}...`);
                document.getElementById('explained-content').innerHTML = '<div class="tw-text-center tw-py-8"><i class="fas fa-spinner tw-spin tw-mr-2"></i>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>';
                
                const content = await fetchGitHubContent(href);
                document.getElementById('explained-content').innerHTML = content;
                document.querySelector('[onclick*="Explained"]').click();
                
                logEvent('LINK_CLICK', `Content loaded for: ${href}`);
            }
        });

        // Helper function
        function updateLoadingStatus(status) {
            document.getElementById('loading-status').textContent = status;
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Psychomatrix - RainbowOrcaKids</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/PsychomatrixStyle.css">
    
    <!-- Favicon -->
    <link rel="icon" href="images/PsychomatixAnalize.png" type="image/png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Version & Status Bar -->
    <div class="bg-gray-800 text-white text-xs p-2 fixed top-0 left-0 right-0 z-50">
        <div class="container mx-auto flex justify-between">
            <div>
                <span id="status" class="font-bold">üîß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...</span>
                <span class="ml-4 text-gray-300">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: result.html v2.0</span>
            </div>
            <div>
                <span id="timestamp" class="text-gray-300"></span>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="container mx-auto px-4 pt-16 pb-8">
        <!-- Header -->
        <div class="text-center mb-8 p-6 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl shadow-lg">
            <h1 class="text-4xl font-bold text-white mb-3">
                <i class="fas fa-calculator mr-3"></i>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Psychomatrix
            </h1>
            <p class="text-blue-100 text-lg">‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏•‡∏±‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
        </div>
        
        <!-- Debug Info Card -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6 border border-blue-200">
            <h2 class="text-xl font-bold text-blue-700 mb-4">
                <i class="fas fa-bug mr-2"></i>Debug Information
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <div class="font-semibold text-blue-800">JavaScript Status</div>
                    <div id="js-status" class="text-green-600 font-bold">‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</div>
                </div>
                <div class="bg-yellow-50 p-4 rounded-lg">
                    <div class="font-semibold text-yellow-800">Session Storage</div>
                    <div id="session-status" class="text-yellow-600 font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                    <div class="font-semibold text-green-800">Supabase Connection</div>
                    <div id="supabase-status" class="text-green-600 font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</div>
                </div>
            </div>
        </div>
        
        <!-- Main Result Area -->
        <div class="bg-white rounded-xl shadow-xl p-6 mb-6">
            <!-- Loading State -->
            <div id="loading-section" class="text-center py-12">
                <div class="inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mb-4"></div>
                <h3 class="text-2xl font-bold text-gray-700 mb-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</h3>
                <p class="text-gray-500" id="loading-detail">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
            </div>
            
            <!-- Results (Hidden by default) -->
            <div id="result-section" class="hidden">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    <i class="fas fa-chart-bar mr-3 text-blue-500"></i>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
                </h2>
                
                <!-- Birth Date Card -->
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-blue-800 mb-2">üìÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</h3>
                    <div class="text-3xl font-bold text-blue-600" id="birth-date-display">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                </div>
                
                <!-- Results Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <!-- Destiny Number -->
                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-6">
                        <h3 class="text-lg font-bold text-purple-800 mb-2">
                            <i class="fas fa-dice mr-2"></i>‡πÄ‡∏•‡∏Ç‡∏†‡∏≤‡∏£‡∏∞‡∏Å‡∏¥‡∏à (Destiny)
                        </h3>
                        <div class="flex items-center">
                            <div class="text-5xl font-bold text-purple-600 mr-4" id="destiny-number">-</div>
                            <div>
                                <p class="text-gray-600">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤</p>
                                <p class="text-sm text-gray-500" id="destiny-detail"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Life Path Number -->
                    <div class="bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-xl p-6">
                        <h3 class="text-lg font-bold text-green-800 mb-2">
                            <i class="fas fa-road mr-2"></i>‡πÄ‡∏•‡∏Ç‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï (Life Path)
                        </h3>
                        <div class="flex items-center">
                            <div class="text-5xl font-bold text-green-600 mr-4" id="life-path-number">-</div>
                            <div>
                                <p class="text-gray-600">‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                                <p class="text-sm text-gray-500" id="life-path-detail"></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SQL Query Section -->
                <div class="bg-gray-50 border border-gray-200 rounded-xl p-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">
                        <i class="fas fa-database mr-2"></i>SQL Query Results
                    </h3>
                    
                    <!-- Query Info -->
                    <div class="mb-4">
                        <div class="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto">
                            <div class="mb-2">SELECT * FROM numerology_search_index</div>
                            <div>WHERE element_type = 'LifePath' AND root_number = <span id="query-number" class="text-yellow-300">6</span></div>
                        </div>
                    </div>
                    
                    <!-- Results Table -->
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-300 rounded-lg">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">id</th>
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">element_type</th>
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">root_number</th>
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">title</th>
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">summary</th>
                                    <th class="py-3 px-4 border-b text-left text-sm font-semibold text-gray-700">html_path</th>
                                </tr>
                            </thead>
                            <tbody id="sql-results-body">
                                <tr>
                                    <td colspan="6" class="py-8 text-center text-gray-500">
                                        <i class="fas fa-spinner fa-spin mr-2"></i>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- GitHub Content Preview -->
                    <div id="github-preview" class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg hidden">
                        <h4 class="font-bold text-blue-800 mb-2">
                            <i class="fab fa-github mr-2"></i>GitHub Content Preview
                        </h4>
                        <div class="text-sm text-gray-600 mb-2" id="github-path"></div>
                        <div class="bg-white border border-gray-300 rounded p-4 max-h-64 overflow-y-auto" id="github-content">
                            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å GitHub Pages...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Error State -->
            <div id="error-section" class="hidden text-center py-12">
                <div class="text-red-500 text-5xl mb-4">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-700 mb-2">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                <p class="text-gray-500 mb-6" id="error-message"></p>
                <a href="Psychomatrix.html" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg inline-flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i>‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°
                </a>
            </div>
        </div>
        
        <!-- Test Buttons -->
        <div class="text-center mt-8">
            <button onclick="runTestQuery()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg mr-4">
                <i class="fas fa-play mr-2"></i>‡∏ó‡∏î‡∏™‡∏≠‡∏ö SQL Query
            </button>
            <button onclick="loadTestData()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-lg">
                <i class="fas fa-vial mr-2"></i>‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/supabase-config.js"></script>
    <script src="js/debug-logger.js"></script>
    
    <script>
        // ==================== CONFIGURATION ====================
        const VERSION = 'result.html v2.0';
        let supabaseClient = null;
        
        // ==================== UTILITY FUNCTIONS ====================
        function updateStatus(text, type = 'info') {
            const statusEl = document.getElementById('status');
            const colors = {
                info: 'text-white',
                success: 'text-green-300',
                warning: 'text-yellow-300',
                error: 'text-red-300'
            };
            
            statusEl.textContent = text;
            statusEl.className = `font-bold ${colors[type] || 'text-white'}`;
            
            if (window.DebugLogger && window.DebugLogger.log) {
                window.DebugLogger.log(`STATUS: ${text}`, type);
            } else {
                console.log(`[${type.toUpperCase()}] ${text}`);
            }
        }
        
        function updateDebugInfo(key, value, isSuccess = true) {
            const element = document.getElementById(`${key}-status`);
            if (element) {
                element.textContent = value;
                element.className = isSuccess ? 'text-green-600 font-bold' : 'text-red-600 font-bold';
            }
        }
        
        function showLoading(detail = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...') {
            document.getElementById('loading-detail').textContent = detail;
            document.getElementById('loading-section').classList.remove('hidden');
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('error-section').classList.add('hidden');
        }
        
        function showResults() {
            document.getElementById('loading-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('error-section').classList.add('hidden');
        }
        
        function showError(message) {
            document.getElementById('loading-section').classList.add('hidden');
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('error-section').classList.remove('hidden');
            document.getElementById('error-message').textContent = message;
            
            updateStatus(`‚ùå ${message}`, 'error');
        }
        
        // ==================== SUPABASE FUNCTIONS ====================
        async function initializeSupabase() {
            try {
                updateStatus('üîó ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Supabase...', 'info');
                updateDebugInfo('supabase', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...', false);
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ config ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (!window.SUPABASE_URL || !window.SUPABASE_ANON_KEY) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö Supabase configuration');
                }
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á Supabase client
                supabaseClient = window.supabase.createClient(
                    window.SUPABASE_URL,
                    window.SUPABASE_ANON_KEY
                );
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                const { data, error } = await supabaseClient
                    .from('numerology_search_index')
                    .select('count')
                    .limit(1);
                
                if (error) throw error;
                
                updateDebugInfo('supabase', '‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                updateStatus('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Supabase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                return true;
                
            } catch (error) {
                console.error('Supabase initialization error:', error);
                updateDebugInfo('supabase', `‚ùå ${error.message}`, false);
                updateStatus(`‚ùå Supabase error: ${error.message}`, 'error');
                return false;
            }
        }
        
        async function queryLifePathData(rootNumber = 6) {
            try {
                updateStatus(`üì° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LifePath ${rootNumber}...`, 'info');
                
                const { data, error } = await supabaseClient
                    .from('numerology_search_index')
                    .select('*')
                    .eq('element_type', 'LifePath')
                    .eq('root_number', rootNumber);
                
                if (error) throw error;
                
                if (!data || data.length === 0) {
                    throw new Error(`‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LifePath ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö root_number = ${rootNumber}`);
                }
                
                updateStatus(`‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LifePath: ${data.length} records`, 'success');
                return data[0]; // ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡πÅ‡∏Ñ‡πà 1 record
                
            } catch (error) {
                console.error('Query error:', error);
                updateStatus(`‚ùå Query failed: ${error.message}`, 'error');
                throw error;
            }
        }
        
        async function queryDestinyData(destinyNumber) {
            try {
                updateStatus(`üì° ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Destiny ${destinyNumber}...`, 'info');
                
                const { data, error } = await supabaseClient
                    .from('numerology_search_index')
                    .select('*')
                    .eq('element_type', 'Destiny')
                    .eq('id', destinyNumber);
                
                if (error) throw error;
                
                if (!data || data.length === 0) {
                    console.warn(`‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Destiny ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö id = ${destinyNumber}`);
                    return null;
                }
                
                updateStatus(`‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Destiny`, 'success');
                return data[0];
                
            } catch (error) {
                console.error('Query error:', error);
                updateStatus(`‚ö†Ô∏è Destiny query warning: ${error.message}`, 'warning');
                return null;
            }
        }
        
        // ==================== DATA PROCESSING ====================
        function renderSQLResults(lifePathData) {
            if (!lifePathData) return;
            
            const tbody = document.getElementById('sql-results-body');
            const { id, element_type, root_number, title, summary, html_path } = lifePathData;
            
            tbody.innerHTML = `
                <tr class="hover:bg-gray-50">
                    <td class="py-3 px-4 border-b text-sm">${id || '-'}</td>
                    <td class="py-3 px-4 border-b text-sm">
                        <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                            ${element_type || '-'}
                        </span>
                    </td>
                    <td class="py-3 px-4 border-b text-sm font-bold text-green-600">${root_number || '-'}</td>
                    <td class="py-3 px-4 border-b text-sm">${title || '-'}</td>
                    <td class="py-3 px-4 border-b text-sm text-gray-600 max-w-xs">${summary || '-'}</td>
                    <td class="py-3 px-4 border-b text-sm">
                        <code class="text-xs bg-gray-100 p-1 rounded">${html_path || '-'}</code>
                    </td>
                </tr>
            `;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï query number
            document.getElementById('query-number').textContent = root_number;
            
            // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ html_path ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á GitHub preview
            if (html_path) {
                document.getElementById('github-preview').classList.remove('hidden');
                document.getElementById('github-path').textContent = html_path;
                loadGitHubContent(html_path);
            }
        }
        
        function loadTestData() {
            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö (‡πÄ‡∏°‡∏∑‡πà‡∏≠ Psychomatrix.js ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤)
            const testData = {
                birth_date: "13:05 22/05/1968",
                destiny_number: 42,
                life_path_number: 6,
                life_path_meaning: "‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏™‡∏π‡∏á ‡∏£‡∏±‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß..."
            };
            
            renderTestData(testData);
            updateStatus('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
        }
        
        function renderTestData(data) {
            document.getElementById('birth-date-display').textContent = data.birth_date;
            document.getElementById('destiny-number').textContent = data.destiny_number;
            document.getElementById('life-path-number').textContent = data.life_path_number;
            document.getElementById('life-path-detail').textContent = data.life_path_meaning || '';
            
            showResults();
        }
        
        async function loadGitHubContent(path) {
            try {
                const cleanPath = path.startsWith('/') ? path : `/${path}`;
                const url = `https://rainboworcakids-collab.github.io/rainboworcakids${cleanPath}`;
                
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const html = await response.text();
                document.getElementById('github-content').innerHTML = html;
                
            } catch (error) {
                document.getElementById('github-content').innerHTML = 
                    `<div class="text-red-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏î‡πâ: ${error.message}</div>`;
            }
        }
        
        // ==================== MAIN EXECUTION ====================
        async function initializePage() {
            try {
                console.log('=== INITIALIZING RESULT PAGE ===');
                updateStatus('üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...', 'info');
                
                // ‡∏ï‡∏±‡πâ‡∏á timestamp
                document.getElementById('timestamp').textContent = 
                    `‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤: ${new Date().toLocaleTimeString('th-TH')}`;
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Session Storage
                const sessionData = sessionStorage.getItem('psychomatrixResult');
                if (sessionData) {
                    try {
                        const parsed = JSON.parse(sessionData);
                        updateDebugInfo('session', '‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Psychomatrix.js');
                        updateStatus('üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å sessionStorage', 'success');
                        
                        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        renderTestData(parsed);
                        
                    } catch (parseError) {
                        console.warn('Cannot parse sessionStorage data:', parseError);
                        updateDebugInfo('session', '‚ùå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                    }
                } else {
                    updateDebugInfo('session', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
                
                // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Supabase
                const supabaseConnected = await initializeSupabase();
                
                if (supabaseConnected) {
                    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LifePath 6 (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
                    const lifePathData = await queryLifePathData(6);
                    
                    if (lifePathData) {
                        renderSQLResults(lifePathData);
                        updateStatus('‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SQL ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    }
                    
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å sessionStorage ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Destiny ‡∏î‡πâ‡∏ß‡∏¢
                    if (sessionData) {
                        try {
                            const parsed = JSON.parse(sessionData);
                            if (parsed.destiny_number) {
                                const destinyData = await queryDestinyData(parsed.destiny_number);
                                if (destinyData) {
                                    document.getElementById('destiny-detail').textContent = destinyData.title || '';
                                }
                            }
                        } catch (e) {
                            // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£
                        }
                    }
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                setTimeout(() => {
                    if (!document.getElementById('result-section').classList.contains('hidden')) {
                        showResults();
                    }
                }, 1000);
                
                console.log('=== PAGE INITIALIZED ===');
                
            } catch (error) {
                console.error('Initialization error:', error);
                showError(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);
            }
        }
        
        // ==================== TEST FUNCTIONS ====================
        async function runTestQuery() {
            try {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö SQL Query...');
                
                const testData = await queryLifePathData(6);
                if (testData) {
                    renderSQLResults(testData);
                    showResults();
                    updateStatus('‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö SQL Query ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                }
                
            } catch (error) {
                showError(`‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${error.message}`);
            }
        }
        
        // ==================== EVENT LISTENERS ====================
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üìÑ DOM Content Loaded');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Debug Logger
            if (window.DebugLogger && typeof window.DebugLogger.init === 'function') {
                try {
                    window.DebugLogger.init();
                    console.log('‚úÖ DebugLogger initialized');
                } catch (e) {
                    console.warn('‚ö†Ô∏è DebugLogger init failed, using console');
                }
            }
            
            // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            await initializePage();
        });
        
        // ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ
        window.runTestQuery = runTestQuery;
        window.loadTestData = loadTestData;
    </script>
</body>
</html>

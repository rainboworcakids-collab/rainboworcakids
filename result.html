<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychomatrix Analysis Results</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.0.0"></script>
    
    <!-- Psychomatrix Main CSS -->
    <link rel="stylesheet" href="css/PsychomatrixStyle.css">
    <link rel="stylesheet" href="css/result-style.css">
    
    <!-- Favicon -->
    <link rel="icon" href="images/PsychomatixAnalize.png" type="image/png">
    
    <!-- Tailwind config -->
    <script>
    tailwind.config = {
        prefix: 'tw-',
        corePlugins: {
            preflight: false
        }
    }
    </script>
    
    <!-- Global Variables and Initialization -->
    <script>
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global ‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô
        window.analysisData = null;
        window.pinnacleData = null;
        window.lifePathProperties = null;
        window.CONTENTS_DIR = 'PsychomatrixContents';
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô GitHub Pages ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const currentPath = window.location.pathname;
        const isGitHubPages = window.location.hostname.includes('github.io');
        
        if (isGitHubPages) {
            // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub Pages
            const pathParts = currentPath.split('/').filter(p => p);
            const REPO_NAME = pathParts[0] || 'rainboworcakids';
            window.BASE_PATH = `/${REPO_NAME}/${window.CONTENTS_DIR}`;
            console.log('üåê DEBUG: GitHub Pages mode, BASE_PATH:', window.BASE_PATH);
        } else {
            // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Apache/localhost
            const folderPath = currentPath.substring(0, currentPath.lastIndexOf('/'));
            window.BASE_PATH = `${folderPath}/${window.CONTENTS_DIR}`;
            console.log('üåê DEBUG: Apache mode, BASE_PATH:', window.BASE_PATH);
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
        function checkScriptLoading() {
            console.log('üîç DEBUG: Checking script loading status...');
            console.log('  - window.switchTab:', typeof window.switchTab);
            console.log('  - window.pythagorean:', window.pythagorean);
            console.log('  - window.analysisData:', window.analysisData);
        }
        
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
        window.addEventListener('load', function() {
            setTimeout(checkScriptLoading, 1000);
        });
    </script>
</head>
<body class="tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-gray-100 tw-p-2 tw-mb-1">

    <!-- Version Badge -->
    <div class="version-badge">
        v7.31-Multi-File
    </div>
    
    <!-- Tab Buttons -->
    <div class="tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-rounded tw-shadow">
        <button class="tablink" onclick="switchTab('Main', this)" id="defaultOpen">Main</button>
        <button class="tablink" onclick="switchTab('Explained', this)">Explained</button>
    </div>
    
    <!-- Main Tab -->
    <div id="Main" class="tabcontent printable tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-6 tw-mb-1 tw-overflow-y-auto tw-max-h-[90vh] active">
        <h1 class="tw-text-3xl tw-font-bold tw-text-center tw-mb-2 tw-flex tw-items-center tw-justify-center">
            <img src="images/PsychomatixAnalize.png" alt="Psychomatrix Logo" class="tw-h-18 tw-w-18 tw-mr-4">
            Psychomatrix Analysis
        </h1>
        
        <!-- Loading State -->
        <div id="loadingSection" class="tw-text-center tw-py-8">
            <div class="spinner"></div>
            <p class="tw-mt-4 tw-text-gray-600">Loading analysis results...</p>
            <p id="loadingDetails" class="tw-mt-2 tw-text-sm tw-text-gray-500"></p>
        </div>
        
        <!-- Error State -->
        <div id="errorSection" class="tw-hidden tw-text-center tw-py-8">
            <div class="tw-text-red-500 tw-text-4xl tw-mb-4">‚ö†Ô∏è</div>
            <h3 class="tw-text-xl tw-font-semibold tw-text-red-600">No analysis data found</h3>
            <p id="errorMessage" class="tw-text-gray-600 tw-mt-2">Please fill in the data on Psychomatrix.html first</p>
            <div id="debugInfo" class="tw-mt-4 tw-p-4 tw-bg-gray-100 tw-rounded tw-text-left tw-text-sm tw-font-mono tw-hidden">
                <p><strong>Debug Information:</strong></p>
                <p id="debugSessionStorage"></p>
                <p id="debugURLParams"></p>
                <p id="debugLocalStorage"></p>
            </div>
            <button onclick="window.location.href='Psychomatrix.html'" class="tw-mt-4 tw-bg-blue-500 hover:tw-bg-blue-600 tw-text-white tw-font-bold tw-py-2 tw-px-6 tw-rounded">
                Return to Input Form
            </button>
            <button onclick="toggleDebugInfo()" class="tw-mt-2 tw-bg-gray-500 hover:tw-bg-gray-600 tw-text-white tw-font-bold tw-py-2 tw-px-6 tw-rounded">
                Show Debug Info
            </button>
        </div>
        
        <!-- Results Container -->
        <div id="resultsContainer" class="tw-hidden">
            <!-- Results will be inserted here -->
        </div>
        
        <!-- Debug Buttons -->
        <div class="tw-mt-8 tw-text-center tw-border-t tw-pt-4">
            <button onclick="testFunctions()" class="tw-bg-gray-500 hover:tw-bg-gray-600 tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded tw-text-sm">
                Test All Functions
            </button>
        </div>
        
        <div class="tw-mt-4 tw-text-right">
            <span onclick="window.location.href='Psychomatrix.html'" class="tw-text-blue-500 hover:tw-underline tw-cursor-pointer">Return to Input Form</span>
        </div>
    </div>
    
    <!-- Explained Tab -->
    <div id="Explained" class="tabcontent printable tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-6 tw-mb-1 tw-overflow-y-auto tw-max-h-[90vh]">
        <div id="explainedContent" class="explained-content"></div>
    </div>
    
    <!--  ‡πÇ‡∏´‡∏•‡∏î Debug Logger ‡∏Å‡πà‡∏≠‡∏ô -->
    <script src="js/debug-logger.js"></script>

    <!-- JavaScript Files - ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á -->
    <script src="js/pythagorean.js"></script>
    <script src="js/result.js"></script>

      
    
    <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à -->
    <script>
        function testFunctions() {
            console.log('üß™ DEBUG: Testing all functions...');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≤‡∏Å result.js
            console.log('üìã result.js functions:');
            console.log('  - switchTab:', typeof switchTab);
            console.log('  - loadAndDisplayResults:', typeof loadAndDisplayResults);
            console.log('  - loadExplainedContent:', typeof loadExplainedContent);
            console.log('  - showPythagoreanSquare:', typeof showPythagoreanSquare);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≤‡∏Å pythagorean.js
            console.log('üìã pythagorean.js functions:');
            console.log('  - window.pythagorean:', window.pythagorean);
            if (window.pythagorean) {
                console.log('    - showPythagoreanSquare:', typeof window.pythagorean.showPythagoreanSquare);
                console.log('    - showCombinedPythagoreanSquare:', typeof window.pythagorean.showCombinedPythagoreanSquare);
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
            console.log('üìã Global variables:');
            console.log('  - window.analysisData:', window.analysisData);
            console.log('  - window.BASE_PATH:', window.BASE_PATH);
            console.log('  - window.CONTENTS_DIR:', window.CONTENTS_DIR);
            
            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°
            const resultContainer = document.getElementById('resultsContainer');
            if (resultContainer && resultContainer.innerHTML.includes('Pythagorean Square')) {
                console.log('‚úÖ Pythagorean buttons found in page');
            } else {
                console.log('‚ùå No Pythagorean buttons found in page');
            }
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DEBUG: DOM fully loaded');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô sessionStorage ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            const psychomatrixResult = sessionStorage.getItem('psychomatrixResult');
            if (psychomatrixResult) {
                try {
                    window.analysisData = JSON.parse(psychomatrixResult);
                    console.log('‚úÖ DEBUG: Loaded analysisData from sessionStorage');
                } catch (error) {
                    console.error('‚ùå DEBUG: Error parsing sessionStorage data:', error);
                }
            }
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå JavaScript ‡πÄ‡∏™‡∏£‡πá‡∏à
            setTimeout(() => {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô initializePage ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (typeof initializePage === 'function') {
                    initializePage();
                } else {
                    console.error('‚ùå CRITICAL: initializePage function not found!');
                    // ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î default tab ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
                    try {
                        document.getElementById("defaultOpen").click();
                    } catch (error) {
                        console.error('‚ùå Error opening default tab:', error);
                    }
                }
            }, 100);
        });
    </script>

</body>
</html>

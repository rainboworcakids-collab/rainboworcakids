<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychomatrix Analysis Results</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@2.0.0"></script>
    
    <!-- Psychomatrix Main CSS -->
    <link rel="stylesheet" href="css/PsychomatrixStyle.css">
    <link rel="stylesheet" href="css/result-style.css">
    
    <!-- Favicon -->
    <link rel="icon" href="images/PsychomatixAnalize.png" type="image/png">
    
    <!-- Tailwind config -->
    <script>
    tailwind.config = {
        prefix: 'tw-',
        corePlugins: {
            preflight: false
        }
    }
    </script>

    <script>
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô GitHub Pages ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    const currentPath = window.location.pathname;
    const isGitHubPages = window.location.hostname.includes('github.io');
    
    if (isGitHubPages) {
        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub Pages - ‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏á‡πà‡∏≤‡∏¢‡πÜ
        // ‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠ repo ‡∏à‡∏≤‡∏Å path
        const pathParts = currentPath.split('/').filter(p => p);
        const repoName = pathParts[0] || 'rainboworcakids';
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ BASE_PATH
        window.BASE_PATH = `/${repoName}/PsychomatrixContents`;
        console.log('üåê DEBUG: ‡πÇ‡∏´‡∏°‡∏î GitHub Pages, BASE_PATH:', window.BASE_PATH);
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        window.SCRIPT_VERSIONS = {
            resultJs: '7.4',
            pythagoreanJs: '7.4',
            debugLoggerJs: '7.4'
        };
        
        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç path ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå JavaScript ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ô URL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô cache
        document.addEventListener('DOMContentLoaded', function() {
            const timestamp = Date.now();
            const scripts = document.querySelectorAll('script[src^="js/"]');
            
            scripts.forEach(script => {
                const oldSrc = script.getAttribute('src');
                const baseSrc = oldSrc.replace(/\?.*$/, ''); // ‡∏•‡∏ö query string ‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å
                const newSrc = `/${repoName}/${baseSrc}?v=${window.SCRIPT_VERSIONS[baseSrc.replace('js/', '').replace('.js', '')] || timestamp}`;
                console.log(`üîÑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô path: ${oldSrc} -> ${newSrc}`);
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á script ‡πÉ‡∏´‡∏°‡πà
                const newScript = document.createElement('script');
                newScript.src = newSrc;
                newScript.onload = function() {
                    console.log(`‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${newSrc}`);
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                    if (newSrc.includes('result.js') && typeof initializePage === 'function') {
                        console.log('‚úÖ result.js ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                    }
                    if (newSrc.includes('pythagorean.js') && window.pythagorean) {
                        console.log('‚úÖ pythagorean.js ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                    }
                };
                newScript.onerror = function() {
                    console.error(`‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${newSrc}`);
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
                    const errorSection = document.getElementById('errorSection');
                    const errorMessage = document.getElementById('errorMessage');
                    if (errorSection && errorMessage) {
                        errorMessage.textContent = `Failed to load ${newSrc}. Please refresh the page.`;
                        errorSection.classList.remove('tw-hidden');
                        document.getElementById('loadingSection').classList.add('tw-hidden');
                    }
                };
                
                // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà script ‡πÄ‡∏î‡∏¥‡∏°
                script.parentNode.replaceChild(newScript, script);
            });
        });
        
    } else {
        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Apache/localhost
        const folderPath = currentPath.substring(0, currentPath.lastIndexOf('/'));
        window.BASE_PATH = `${folderPath}/PsychomatrixContents`;
        console.log('üåê DEBUG: ‡πÇ‡∏´‡∏°‡∏î Apache, BASE_PATH:', window.BASE_PATH);
        
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô
        window.SCRIPT_VERSIONS = {
            resultJs: '7.5',
            pythagoreanJs: '7.5',
            debugLoggerJs: '7.5'
        };
    }
</script>
    
</head>
<body class="tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-gray-100 tw-p-2 tw-mb-1">

    <!-- Version Badge -->
    <div class="version-badge">
        v7.5
    </div>
    
    <!-- Tab Buttons -->
    <div class="tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-rounded tw-shadow">
        <button class="tablink" onclick="switchTab('Main', this)" id="defaultOpen">Main</button>
        <button class="tablink" onclick="switchTab('Explained', this)">Explained</button>
    </div>
    
    <!-- Main Tab -->
    <div id="Main" class="tabcontent printable tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-6 tw-mb-1 tw-overflow-y-auto tw-max-h-[90vh] active">
        <h1 class="tw-text-3xl tw-font-bold tw-text-center tw-mb-2 tw-flex tw-items-center tw-justify-center">
            <img src="images/PsychomatixAnalize.png" alt="Psychomatrix Logo" class="tw-h-18 tw-w-18 tw-mr-4">
            Psychomatrix Analysis
        </h1>
        
        <!-- Debug Info Display -->
        <div id="scriptStatus" class="tw-mb-4 tw-p-3 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-text-sm tw-hidden">
            <h4 class="tw-font-bold tw-text-yellow-700">Script Status</h4>
            <div class="tw-grid tw-grid-cols-2 tw-gap-2 tw-mt-2">
                <div id="resultJsStatus" class="tw-p-2 tw-bg-white tw-rounded">result.js: <span class="tw-text-gray-500">Loading...</span></div>
                <div id="pythagoreanJsStatus" class="tw-p-2 tw-bg-white tw-rounded">pythagorean.js: <span class="tw-text-gray-500">Loading...</span></div>
                <div id="debugLoggerStatus" class="tw-p-2 tw-bg-white tw-rounded">debug-logger.js: <span class="tw-text-gray-500">Loading...</span></div>
                <div id="dataStatus" class="tw-p-2 tw-bg-white tw-rounded">Data: <span class="tw-text-gray-500">Checking...</span></div>
            </div>
        </div>
        
        <!-- Loading State -->
        <div id="loadingSection" class="tw-text-center tw-py-8">
            <div class="spinner"></div>
            <p class="tw-mt-4 tw-text-gray-600">Loading analysis results...</p>
            <p id="loadingDetails" class="tw-mt-2 tw-text-sm tw-text-gray-500"></p>
            <div id="loadingProgress" class="tw-mt-4 tw-w-full tw-bg-gray-200 tw-rounded-full tw-h-2.5">
                <div id="loadingBar" class="tw-bg-blue-600 tw-h-2.5 tw-rounded-full" style="width: 0%"></div>
            </div>
        </div>
        
        <!-- Error State -->
        <div id="errorSection" class="tw-hidden tw-text-center tw-py-8">
            <div class="tw-text-red-500 tw-text-4xl tw-mb-4">‚ö†Ô∏è</div>
            <h3 class="tw-text-xl tw-font-semibold tw-text-red-600">No analysis data found</h3>
            <p id="errorMessage" class="tw-text-gray-600 tw-mt-2">Please fill in the data on Psychomatrix.html first</p>
            <div id="debugInfo" class="tw-mt-4 tw-p-4 tw-bg-gray-100 tw-rounded tw-text-left tw-text-sm tw-font-mono tw-hidden">
                <p><strong>Debug Information:</strong></p>
                <p id="debugSessionStorage"></p>
                <p id="debugURLParams"></p>
                <p id="debugLocalStorage"></p>
            </div>
            <button onclick="window.location.href='Psychomatrix.html'" class="tw-mt-4 tw-bg-blue-500 hover:tw-bg-blue-600 tw-text-white tw-font-bold tw-py-2 tw-px-6 tw-rounded">
                Return to Input Form
            </button>
            <button onclick="toggleDebugInfo()" class="tw-mt-2 tw-bg-gray-500 hover:tw-bg-gray-600 tw-text-white tw-font-bold tw-py-2 tw-px-6 tw-rounded">
                Show Debug Info
            </button>
        </div>
        
        <!-- Results Container -->
        <div id="resultsContainer" class="tw-hidden">
            <!-- Results will be inserted here -->
        </div>
        
        <!-- Debug Buttons -->
        <div class="tw-mt-8 tw-text-center tw-border-t tw-pt-4">
            <button onclick="testFunctions()" class="tw-bg-gray-500 hover:tw-bg-gray-600 tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded tw-text-sm">
                Test All Functions
            </button>
            <button onclick="forceReloadScripts()" class="tw-bg-red-500 hover:tw-bg-red-600 tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded tw-text-sm tw-ml-2">
                Force Reload Scripts
            </button>
        </div>
        
        <div class="tw-mt-4 tw-text-right">
            <span onclick="window.location.href='Psychomatrix.html'" class="tw-text-blue-500 hover:tw-underline tw-cursor-pointer">Return to Input Form</span>
        </div>
    </div>
    
    <!-- Explained Tab -->
    <div id="Explained" class="tabcontent printable tw-max-w-4xl tw-mx-h-auto tw-mx-auto tw-bg-white tw-p-6 tw-rounded tw-shadow tw-mt-6 tw-mb-1 tw-overflow-y-auto tw-max-h-[90vh]">
        <div id="explainedContent" class="explained-content"></div>
    </div>

    <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
    <div class="tw-mt-4 tw-text-center">
        <button onclick="checkAllScripts()" class="tw-bg-yellow-500 hover:tw-bg-yellow-600 tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded tw-text-sm">
            ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </button>
    </div>
    
    <!-- ‡πÇ‡∏´‡∏•‡∏î Debug Logger ‡∏Å‡πà‡∏≠‡∏ô -->
    <script src="js/debug-logger.js"></script>

    <!-- JavaScript Files - ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á -->
    <script src="js/pythagorean.js"></script>
    <script src="js/result.js"></script>

    <!-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à -->
    <script>
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ loading
        function updateLoading(percent, message) {
            const loadingBar = document.getElementById('loadingBar');
            const loadingDetails = document.getElementById('loadingDetails');
            
            if (loadingBar) {
                loadingBar.style.width = percent + '%';
            }
            if (loadingDetails) {
                loadingDetails.textContent = message;
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
        function updateScriptStatus(scriptName, status, version = '') {
            const statusElement = document.getElementById(scriptName + 'Status');
            const scriptStatusDiv = document.getElementById('scriptStatus');
            
            if (statusElement) {
                let statusClass = 'tw-text-gray-500';
                let statusText = status;
                
                if (status === 'Loaded') {
                    statusClass = 'tw-text-green-600';
                    statusText = 'Loaded' + (version ? ` (v${version})` : '');
                } else if (status === 'Failed') {
                    statusClass = 'tw-text-red-600';
                } else if (status === 'Initialized') {
                    statusClass = 'tw-text-blue-600';
                }
                
                statusElement.innerHTML = `${scriptName}: <span class="${statusClass}">${statusText}</span>`;
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á script status div
            if (scriptStatusDiv) {
                scriptStatusDiv.classList.remove('tw-hidden');
            }
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function checkDataStatus() {
            const psychomatrixResult = sessionStorage.getItem('psychomatrixResult');
            const dataStatusElement = document.getElementById('dataStatus');
            
            if (dataStatusElement) {
                if (psychomatrixResult) {
                    try {
                        const data = JSON.parse(psychomatrixResult);
                        const resultsCount = data.results ? data.results.length : 1;
                        dataStatusElement.innerHTML = `Data: <span class="tw-text-green-600">Loaded (${resultsCount} results)</span>`;
                    } catch (e) {
                        dataStatusElement.innerHTML = `Data: <span class="tw-text-red-600">Invalid JSON</span>`;
                    }
                } else {
                    dataStatusElement.innerHTML = `Data: <span class="tw-text-red-600">No data found</span>`;
                }
            }
        }
        
        function testFunctions() {
            console.log('üß™ DEBUG: Testing all functions...');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≤‡∏Å result.js
            console.log('üìã result.js functions:');
            console.log('  - switchTab:', typeof switchTab);
            console.log('  - loadAndDisplayResults:', typeof loadAndDisplayResults);
            console.log('  - loadExplainedContent:', typeof loadExplainedContent);
            console.log('  - showPythagoreanSquare:', typeof showPythagoreanSquare);
            console.log('  - initializePage:', typeof initializePage);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏≤‡∏Å pythagorean.js
            console.log('üìã pythagorean.js functions:');
            console.log('  - window.pythagorean:', window.pythagorean);
            if (window.pythagorean) {
                console.log('    - showPythagoreanSquare:', typeof window.pythagorean.showPythagoreanSquare);
                console.log('    - showCombinedPythagoreanSquare:', typeof window.pythagorean.showCombinedPythagoreanSquare);
                console.log('    - _calculatePythagoreanSquare:', typeof window.pythagorean._calculatePythagoreanSquare);
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
            console.log('üìã Global variables:');
            console.log('  - window.analysisData:', window.analysisData ? '‚úì Available' : '‚úó Missing');
            console.log('  - window.BASE_PATH:', window.BASE_PATH || 'Not set');
            console.log('  - window.SCRIPT_VERSIONS:', window.SCRIPT_VERSIONS || 'Not set');
            console.log('  - window.lifePathProperties:', window.lifePathProperties ? '‚úì Loaded' : '‚úó Not loaded');
            
            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°
            const resultContainer = document.getElementById('resultsContainer');
            if (resultContainer) {
                console.log('‚úÖ resultsContainer found');
            } else {
                console.log('‚ùå resultsContainer not found');
            }
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            checkDataStatus();
        }
        
        function checkAllScripts() {
            console.log('üîß ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:');
            console.log('1. window.pythagorean:', window.pythagorean);
            console.log('2. typeof showPythagoreanSquare:', typeof showPythagoreanSquare);
            console.log('3. typeof switchTab:', typeof switchTab);
            console.log('4. window.BASE_PATH:', window.BASE_PATH);
            console.log('5. window.analysisData:', window.analysisData ? '‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
            console.log('6. window.SCRIPT_VERSIONS:', window.SCRIPT_VERSIONS);
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ô pythagorean object
            if (window.pythagorean) {
                console.log('7. pythagorean.showPythagoreanSquare:', typeof window.pythagorean.showPythagoreanSquare);
                console.log('8. pythagorean.showCombinedPythagoreanSquare:', typeof window.pythagorean.showCombinedPythagoreanSquare);
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            const scriptStatusDiv = document.getElementById('scriptStatus');
            if (scriptStatusDiv) {
                scriptStatusDiv.classList.remove('tw-hidden');
            }
            
            checkDataStatus();
            
            alert('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‡∏î‡∏π‡∏ú‡∏•‡πÉ‡∏ô Console (F12)');
        }
        
        function forceReloadScripts() {
            console.log('üîÑ Force reloading scripts...');
            
            // ‡∏•‡∏ö cache ‡∏Ç‡∏≠‡∏á localStorage
            localStorage.removeItem('lifePathPropertiesCache');
            
            // ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ global
            delete window.analysisData;
            delete window.lifePathProperties;
            delete window.pythagorean;
            
            // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            window.location.reload(true);
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DEBUG: DOM fully loaded');
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ loading
            updateLoading(10, 'Initializing...');
            updateScriptStatus('resultJs', 'Checking...');
            updateScriptStatus('pythagoreanJs', 'Checking...');
            updateScriptStatus('debugLoggerJs', 'Checking...');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô sessionStorage ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            const psychomatrixResult = sessionStorage.getItem('psychomatrixResult');
            if (psychomatrixResult) {
                try {
                    window.analysisData = JSON.parse(psychomatrixResult);
                    console.log('‚úÖ DEBUG: Loaded analysisData from sessionStorage');
                    updateLoading(30, 'Data loaded from sessionStorage');
                } catch (error) {
                    console.error('‚ùå DEBUG: Error parsing sessionStorage data:', error);
                    updateLoading(30, 'Error parsing data');
                }
            }
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå JavaScript ‡πÄ‡∏™‡∏£‡πá‡∏à
            setTimeout(() => {
                updateLoading(50, 'Checking JavaScript files...');
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                if (typeof initializePage === 'function') {
                    updateScriptStatus('resultJs', 'Loaded', window.SCRIPT_VERSIONS?.resultJs || '7.4');
                    console.log('‚úÖ result.js loaded successfully');
                } else {
                    updateScriptStatus('resultJs', 'Failed');
                    console.error('‚ùå result.js not loaded properly');
                }
                
                if (window.pythagorean) {
                    updateScriptStatus('pythagoreanJs', 'Loaded', window.SCRIPT_VERSIONS?.pythagoreanJs || '7.4');
                    console.log('‚úÖ pythagorean.js loaded successfully');
                } else {
                    updateScriptStatus('pythagoreanJs', 'Failed');
                    console.error('‚ùå pythagorean.js not loaded properly');
                }
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö debug logger
                if (typeof window.debugLogger !== 'undefined') {
                    updateScriptStatus('debugLoggerJs', 'Loaded', window.SCRIPT_VERSIONS?.debugLoggerJs || '7.4');
                } else {
                    updateScriptStatus('debugLoggerJs', 'Loaded (basic)');
                }
                
                updateLoading(70, 'Initializing application...');
                
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å initializePage
                if (typeof initializePage === 'function') {
                    setTimeout(() => {
                        initializePage();
                        updateLoading(90, 'Displaying results...');
                        updateScriptStatus('resultJs', 'Initialized');
                    }, 100);
                } else {
                    console.error('‚ùå CRITICAL: initializePage function not found!');
                    
                    // ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î default tab ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
                    try {
                        document.getElementById("defaultOpen").click();
                        updateLoading(100, 'Fallback initialization');
                    } catch (error) {
                        console.error('‚ùå Error opening default tab:', error);
                        updateLoading(100, 'Initialization failed');
                    }
                }
            }, 100);
        });
    </script>
</body>
</html>

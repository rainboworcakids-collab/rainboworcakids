<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Edge Functions - HarmonyPath</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
        .test-section { background: white; padding: 15px; margin: 10px 0; border-radius: 8px; }
        .result { background: #e8f5e9; padding: 10px; margin-top: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; }
        .error { background: #ffcdd2; }
        button { padding: 10px 15px; background: #1976d2; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üß™ Edge Functions Test Dashboard</h1>
    
    <div class="test-section">
        <h3>1. Test psychomatrix-calculate</h3>
        <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</p>
        <button onclick="testPsychomatrix()">Run Test</button>
        <div id="result-psychomatrix" class="result" style="display:none;"></div>
    </div>

    <script>
        // Supabase config (‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å GitHub Pages environment)
        const SUPABASE_URL = 'https://oibubvhuiuurkxhnefsw.supabase.co';
        const FUNCTION_URL = `${SUPABASE_URL}/functions/v1/psychomatrix-calculate`;
        
        async function testPsychomatrix() {
            const resultDiv = document.getElementById('result-psychomatrix');
            resultDiv.style.display = 'block';
            resultDiv.className = 'result';
            
            // Test data: ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏ö‡∏ö‡πÑ‡∏ó‡∏¢
            const testData = {
                birthdate: "14:30 15/12/1990", // ‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï HH:MM DD/MM/YYYY
                name: "‡∏ó‡∏î‡∏™‡∏≠‡∏ö"
            };
            
            try {
                resultDiv.innerHTML = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                
                const response = await fetch(FUNCTION_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        ‚úÖ <strong>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong><br>
                        Destiny Number: ${data.destiny_number}<br>
                        Life Path: ${data.life_path}<br>
                        Meanings: ${JSON.stringify(data.meanings, null, 2)}
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        ‚ùå <strong>‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!</strong><br>
                        Status: ${response.status}<br>
                        Error: ${JSON.stringify(data, null, 2)}
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    ‚ùå <strong>Network Error!</strong><br>
                    ${error.message}<br>
                    <small>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: 1) CORS settings 2) Function URL 3) Network connection</small>
                `;
            }
        }
        
        // Auto-run test ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î page
        window.onload = () => {
            console.log('üîç Test page loaded. Ready to test Edge Functions.');
            console.log('Function URL:', FUNCTION_URL);
        };
    </script>
</body>
</html>

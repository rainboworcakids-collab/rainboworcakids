<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô - RainbowOrcaKids</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/notifications.css">

</head>
<body class="font-sarabun">
    <!-- Navigation bar ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢ js/nav.js -->
    
    <div class="min-h-screen pb-12">
        <!-- Loading State -->
        <div id="loading" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
            <div class="text-center">
                <div class="spinner mb-4 mx-auto"></div>
                <p class="text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô...</p>
            </div>
        </div>

        <!-- Main Content (hidden initially) -->
        <div id="mainContent" class="hidden">
            <!-- Header Section -->
            <div class="bg-gradient-to-r from-blue-500 via-purple-600 to-purple-700 text-white pt-24 pb-12 px-4">
                <div class="max-w-7xl mx-auto">
                    <!-- Breadcrumb -->
                    <div class="mb-6 text-sm text-blue-100">
                        <a href="missions.html" class="hover:text-white">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a> 
                        <span class="mx-2">/</span>
                        <span class="text-white font-semibold">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</span>
                    </div>
                    
                    <div class="flex flex-col md:flex-row items-center justify-between">
                        <div class="mb-8 md:mb-0">
                            <h1 class="text-3xl md:text-4xl font-bold mb-2">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h1>
                            <p class="text-blue-100">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                        </div>
                        
                        <!-- Notification Stats -->
                        <div class="text-center bg-white/10 backdrop-blur-sm rounded-2xl p-6 shadow-xl">
                            <div class="flex items-center justify-center mb-4">
                                <div class="mr-3">
                                    <i class="fas fa-bell text-4xl text-yellow-300"></i>
                                </div>
                                <div>
                                    <div class="text-2xl text-blue-100">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                    <div class="text-5xl font-bold mt-1" id="unread-count">0</div>
                                    <div class="text-sm text-blue-100 mt-1">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô</div>
                                </div>
                            </div>
                            
                            <div class="flex justify-center space-x-3">
                                <button id="mark-all-read-btn" class="bg-white text-blue-600 font-semibold px-5 py-2 rounded-full hover:bg-blue-50 transition flex items-center">
                                    <i class="fas fa-check-double mr-2"></i> ‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                                </button>
                                <button id="clear-notifications-btn" class="bg-transparent border border-white text-white font-semibold px-5 py-2 rounded-full hover:bg-white/20 transition flex items-center">
                                    <i class="fas fa-trash-alt mr-2"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="max-w-7xl mx-auto px-4 -mt-8">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Left Column: Notifications List -->
                    <div class="lg:col-span-2 space-y-8">
                        <!-- Filter Section -->
                        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div class="flex flex-wrap gap-2 mb-4">
                                <button class="filter-btn active" data-filter="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                                <button class="filter-btn" data-filter="unread">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô</button>
                                <button class="filter-btn" data-filter="missions">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</button>
                                <button class="filter-btn" data-filter="rewards">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
                                <button class="filter-btn" data-filter="system">‡∏£‡∏∞‡∏ö‡∏ö</button>
                                <button class="filter-btn" data-filter="achievements">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</button>
                            </div>
                            
                            <!-- Search and Sort -->
                            <div class="flex flex-col md:flex-row justify-between items-center gap-4 mt-4">
                                <div class="relative w-full md:w-auto">
                                    <input type="text" id="notification-search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô..." 
                                           class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                                </div>
                                <select id="notification-sort" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="newest">‡πÉ‡∏´‡∏°‡πà‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</option>
                                    <option value="oldest">‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</option>
                                    <option value="unread-first">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Notifications List -->
                        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-2xl font-bold text-gray-800">
                                    <i class="fas fa-bell text-blue-500 mr-2"></i> ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                                </h2>
                                <button id="refresh-notifications-btn" class="text-blue-600 hover:text-blue-800 text-sm font-semibold">
                                    <i class="fas fa-redo-alt mr-1"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                                </button>
                            </div>
                            
                            <div class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar p-2" id="notifications-list">
                                <!-- Dynamic notifications will be loaded here -->
                                <div class="text-center py-8 text-gray-400 loading-pulse">
                                    <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô...</p>
                                </div>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="mt-6 pt-6 border-t border-gray-200 flex justify-between items-center">
                                <button id="load-more-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold">
                                    <i class="fas fa-plus mr-1"></i> ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                                </button>
                                <div class="text-sm text-gray-600">
                                    ‡πÅ‡∏™‡∏î‡∏á <span id="showing-count">0</span> ‡∏à‡∏≤‡∏Å <span id="total-count">0</span> ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Column: Notification Settings & Stats -->
                    <div class="space-y-8">
                        <!-- Notification Settings -->
                        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                                <i class="fas fa-cog text-gray-500 mr-2"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                            </h2>
                            
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</div>
                                        <div class="text-sm text-gray-600">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏´‡∏°‡∏î</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="mission-notifications" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</div>
                                        <div class="text-sm text-gray-600">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏Ç‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡πÉ‡∏´‡∏°‡πà</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="reward-notifications" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>
                                        <div class="text-sm text-gray-600">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="system-notifications" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
                                        <div class="text-sm text-gray-600">‡∏™‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="email-notifications" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <button id="save-settings-btn" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-3 rounded-lg font-semibold flex items-center justify-center">
                                    <i class="fas fa-save mr-2"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                                </button>
                            </div>
                        </div>
                        
                        <!-- Notification Stats -->
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl shadow-lg p-6 text-white">
                            <h3 class="text-xl font-bold mb-4">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-blue-100">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                                    <span class="font-bold text-lg" id="stats-total">0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-blue-100">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô</span>
                                    <span class="font-bold" id="stats-unread">0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-blue-100">‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</span>
                                    <span class="font-bold" id="stats-read">0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-blue-100">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</span>
                                    <span class="font-bold" id="stats-missions">0</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-blue-100">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</span>
                                    <span class="font-bold" id="stats-rewards">0</span>
                                </div>
                                <div class="mt-4 pt-4 border-t border-white/30">
                                    <div class="text-center">
                                        <div class="text-sm text-blue-100 mb-1">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                                        <div class="font-bold" id="last-updated">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Help & Tips -->
                        <div class="bg-white rounded-2xl shadow-lg p-6 card-hover">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-question-circle text-blue-500 mr-2"></i> ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠
                            </h3>
                            <div class="space-y-3">
                                <div class="flex items-start">
                                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                                        <div class="text-sm text-gray-600">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° ‚úì ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-filter text-blue-500 mt-1 mr-2"></i>
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏Å‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                        <div class="text-sm text-gray-600">‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏£‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</div>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <i class="fas fa-trash-alt text-red-500 mt-1 mr-2"></i>
                                    <div>
                                        <div class="font-medium text-gray-800">‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                        <div class="text-sm text-gray-600">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error State -->
        <div id="errorState" class="hidden text-center py-10">
            <div class="bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto">
                <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                <h3 class="text-xl font-bold text-red-700 mb-2">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                <p id="errorMessage" class="text-gray-600 mb-4"></p>
                <button onclick="window.location.reload()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg">
                    ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Scripts - ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á -->
    <script src="js/supabase-config.js"></script>
    <script src="js/auth_status_manager.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/debug-manager.js"></script>
  
    <!-- Notifications Page Specific Script -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            console.log("üìÑ Notifications page loaded");
            
            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            async function fetchNotifications() {
                const notificationsList = document.getElementById('notifications-list');
                const loadingElement = document.getElementById('loading');
                const mainContent = document.getElementById('mainContent');
                const errorState = document.getElementById('errorState');
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ element ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                if (!notificationsList || !loadingElement || !mainContent || !errorState) {
                    console.error("‡πÑ‡∏°‡πà‡∏û‡∏ö elements ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£");
                    return;
                }
                
                try {
                    // ‡πÉ‡∏ä‡πâ getSupabaseClient ‡∏à‡∏≤‡∏Å auth_status_manager.js
                    const supabase = await getSupabaseClient();
                    if (!supabase) {
                        loadingElement.classList.add('hidden');
                        errorState.classList.remove('hidden');
                        document.getElementById('errorMessage').textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ';
                        console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ");
                        return;
                    }
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ session ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    const { data: { session } } = await supabase.auth.getSession();
                    
                    if (!session) {
                        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                        console.log("üë§ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á");
                        showMockNotifications();
                        loadingElement.classList.add('hidden');
                        mainContent.classList.remove('hidden');
                        return;
                    }
                    
                    const userId = session.user.id;
                    console.log("‚úÖ User authenticated:", session.user.email);
                    
                    // ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á notifications ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
                    try {
                        const { data: notifications, error } = await supabase
                            .from('notifications')
                            .select('*')
                            .eq('user_id', userId)
                            .order('created_at', { ascending: false });
                        
                        if (error) {
                            console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error.message);
                            showMockNotifications();
                        } else if (notifications && notifications.length > 0) {
                            console.log(`‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${notifications.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                            displayNotifications(notifications);
                        } else {
                            console.log("‚ÑπÔ∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
                            showMockNotifications();
                        }
                    } catch (dbError) {
                        console.warn("‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", dbError.message);
                        showMockNotifications();
                    }
                    
                    loadingElement.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                    
                } catch (error) {
                    console.error('Error fetching notifications:', error);
                    loadingElement.classList.add('hidden');
                    errorState.classList.remove('hidden');
                    document.getElementById('errorMessage').textContent = `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`;
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
            function showMockNotifications() {
                console.log("üìù ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô");
                
                const mockNotifications = [
                    {
                        id: '1',
                        title: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà!',
                        message: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à "‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 1-10" ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß',
                        type: 'missions',
                        is_read: false,
                        created_at: '2025-12-08T10:30:00Z'
                    },
                    {
                        id: '2',
                        title: '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•!',
                        message: '‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏î‡∏≤‡∏ß 50 ‡∏î‡∏≤‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        type: 'rewards',
                        is_read: true,
                        created_at: '2025-12-07T15:45:00Z'
                    },
                    {
                        id: '3',
                        title: '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏ö‡∏ö',
                        message: '‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÅ‡∏Å‡∏•‡πÄ‡∏•‡∏≠‡∏£‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                        type: 'system',
                        is_read: true,
                        created_at: '2025-12-05T09:15:00Z'
                    },
                    {
                        id: '4',
                        title: '‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß!',
                        message: '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö 5 ‡πÅ‡∏•‡πâ‡∏ß',
                        type: 'achievements',
                        is_read: false,
                        created_at: '2025-12-04T14:20:00Z'
                    },
                    {
                        id: '5',
                        title: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤',
                        message: '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à "‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ó‡∏∞‡πÄ‡∏•" ‡∏à‡∏∞‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á',
                        type: 'missions',
                        is_read: false,
                        created_at: '2025-12-03T16:10:00Z'
                    },
                    {
                        id: '6',
                        title: '‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™',
                        message: '‡∏°‡∏µ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏´‡∏°‡πà "‡∏ô‡πâ‡∏≠‡∏á‡∏û‡∏•‡∏≠‡∏¢" ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Ñ‡∏•‡∏≤‡∏™‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',
                        type: 'system',
                        is_read: true,
                        created_at: '2025-12-02T11:05:00Z'
                    },
                    {
                        id: '7',
                        title: '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏Ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏©',
                        message: '‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏Ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© 10 ‡∏ü‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á 7 ‡∏ß‡∏±‡∏ô',
                        type: 'rewards',
                        is_read: false,
                        created_at: '2025-12-01T08:30:00Z'
                    },
                    {
                        id: '8',
                        title: '‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô',
                        message: '‡∏ä‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏°‡∏≤‡πÉ‡∏ä‡πâ RainbowOrcaKids ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÑ‡∏Ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© 20 ‡∏ü‡∏≠‡∏á',
                        type: 'rewards',
                        is_read: true,
                        created_at: '2025-11-30T13:45:00Z'
                    }
                ];
                
                displayNotifications(mockNotifications);
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                const lastUpdated = document.getElementById('last-updated');
                if (lastUpdated) {
                    lastUpdated.textContent = '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á';
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            function displayNotifications(notifications) {
                const notificationsList = document.getElementById('notifications-list');
                if (!notificationsList) return;
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
                updateNotificationStats(notifications);
                
                if (notifications.length === 0) {
                    notificationsList.innerHTML = `
                        <div class="text-center py-8 text-gray-400">
                            <i class="fas fa-bell-slash text-3xl mb-3"></i>
                            <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
                            <p class="text-sm mt-1">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                        </div>
                    `;
                    return;
                }
                
                notificationsList.innerHTML = '';
                
                notifications.forEach(notification => {
                    const notificationElement = createNotificationElement(notification);
                    notificationsList.appendChild(notificationElement);
                });
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á element ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            function createNotificationElement(notification) {
                const element = document.createElement('div');
                element.className = `notification-item ${notification.is_read ? 'read' : 'unread'} border-b border-gray-100 pb-4 last:border-0 last:pb-0`;
                element.dataset.id = notification.id;
                
                // Format date
                const notificationDate = new Date(notification.created_at);
                const timeAgo = getTimeAgo(notificationDate);
                const formattedDate = notificationDate.toLocaleDateString('th-TH', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // Get icon based on type
                let icon = 'fas fa-bell';
                let iconColor = 'text-blue-500';
                let bgColor = 'bg-blue-100';
                
                switch(notification.type) {
                    case 'missions':
                        icon = 'fas fa-flag';
                        iconColor = 'text-green-500';
                        bgColor = 'bg-green-100';
                        break;
                    case 'rewards':
                        icon = 'fas fa-gift';
                        iconColor = 'text-yellow-500';
                        bgColor = 'bg-yellow-100';
                        break;
                    case 'achievements':
                        icon = 'fas fa-trophy';
                        iconColor = 'text-purple-500';
                        bgColor = 'bg-purple-100';
                        break;
                    case 'system':
                        icon = 'fas fa-cog';
                        iconColor = 'text-gray-500';
                        bgColor = 'bg-gray-100';
                        break;
                }
                
                element.innerHTML = `
                    <div class="flex items-start">
                        <div class="w-10 h-10 rounded-full ${bgColor} flex items-center justify-center mr-3 flex-shrink-0">
                            <i class="${icon} ${iconColor}"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <h3 class="font-bold text-gray-800 ${notification.is_read ? '' : 'font-semibold'}">${notification.title}</h3>
                                <div class="flex space-x-2">
                                    <button class="mark-read-btn text-sm ${notification.is_read ? 'text-gray-400' : 'text-blue-600 hover:text-blue-800'}" 
                                            title="${notification.is_read ? '‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô' : '‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß'}">
                                        <i class="fas ${notification.is_read ? 'fa-envelope-open' : 'fa-envelope'}"></i>
                                    </button>
                                    <button class="delete-btn text-sm text-gray-400 hover:text-red-600" 
                                            title="‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-gray-600 mt-1">${notification.message}</p>
                            <div class="flex justify-between items-center mt-2">
                                <div class="text-xs text-gray-500">
                                    <i class="far fa-clock mr-1"></i> ${formattedDate} (${timeAgo})
                                </div>
                                <span class="px-2 py-1 text-xs rounded-full ${notification.is_read ? 'bg-gray-100 text-gray-600' : 'bg-blue-100 text-blue-600'}">
                                    ${getTypeLabel(notification.type)}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°
                const markReadBtn = element.querySelector('.mark-read-btn');
                const deleteBtn = element.querySelector('.delete-btn');
                
                markReadBtn.addEventListener('click', () => {
                    toggleReadStatus(notification.id, element);
                });
                
                deleteBtn.addEventListener('click', () => {
                    deleteNotification(notification.id, element);
                });
                
                return element;
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
            function updateNotificationStats(notifications) {
                const total = notifications.length;
                const unread = notifications.filter(n => !n.is_read).length;
                const read = total - unread;
                
                const missions = notifications.filter(n => n.type === 'missions').length;
                const rewards = notifications.filter(n => n.type === 'rewards').length;
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô UI
                const elements = {
                    'unread-count': unread,
                    'stats-total': total,
                    'stats-unread': unread,
                    'stats-read': read,
                    'stats-missions': missions,
                    'stats-rewards': rewards
                };
                
                for (const [id, value] of Object.entries(elements)) {
                    const element = document.getElementById(id);
                    if (element) {
                        element.textContent = value;
                    }
                }
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                if (notifications.length > 0) {
                    const latest = new Date(notifications[0].created_at);
                    const formatted = latest.toLocaleDateString('th-TH', {
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    const lastUpdated = document.getElementById('last-updated');
                    if (lastUpdated) {
                        lastUpdated.textContent = formatted;
                    }
                }
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á
                const showingCount = document.getElementById('showing-count');
                const totalCount = document.getElementById('total-count');
                if (showingCount) showingCount.textContent = notifications.length;
                if (totalCount) totalCount.textContent = notifications.length;
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô toggle ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô
            async function toggleReadStatus(notificationId, element) {
                try {
                    const supabase = await getSupabaseClient();
                    if (!supabase) {
                        console.warn("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Supabase ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞");
                        return;
                    }
                    
                    // ‡∏´‡∏≤ notification ‡∏à‡∏≤‡∏Å element
                    const isRead = element.classList.contains('read');
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                    if (isRead) {
                        element.classList.remove('read');
                        element.classList.add('unread');
                        const markReadBtn = element.querySelector('.mark-read-btn');
                        const icon = element.querySelector('.mark-read-btn i');
                        if (markReadBtn) {
                            markReadBtn.classList.remove('text-gray-400');
                            markReadBtn.classList.add('text-blue-600', 'hover:text-blue-800');
                        }
                        if (icon) {
                            icon.className = 'fas fa-envelope';
                        }
                    } else {
                        element.classList.remove('unread');
                        element.classList.add('read');
                        const markReadBtn = element.querySelector('.mark-read-btn');
                        const icon = element.querySelector('.mark-read-btn i');
                        if (markReadBtn) {
                            markReadBtn.classList.remove('text-blue-600', 'hover:text-blue-800');
                            markReadBtn.classList.add('text-gray-400');
                        }
                        if (icon) {
                            icon.className = 'fas fa-envelope-open';
                        }
                    }
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà
                    setTimeout(() => {
                        const allNotifications = document.querySelectorAll('.notification-item');
                        const notificationsArray = Array.from(allNotifications).map(el => ({
                            id: el.dataset.id,
                            is_read: el.classList.contains('read')
                        }));
                        updateNotificationStats(notificationsArray);
                    }, 100);
                    
                    console.log(`‚úÖ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö notification ID: ${notificationId}`);
                    
                } catch (error) {
                    console.error('Error toggling read status:', error);
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            async function deleteNotification(notificationId, element) {
                if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    return;
                }
                
                try {
                    const supabase = await getSupabaseClient();
                    
                    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ supabase client ‡πÉ‡∏´‡πâ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    if (supabase) {
                        const { error } = await supabase
                            .from('notifications')
                            .delete()
                            .eq('id', notificationId);
                        
                        if (error) {
                            console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:", error.message);
                        }
                    }
                    
                    // ‡∏•‡∏ö‡∏à‡∏≤‡∏Å UI
                    element.remove();
                    
                    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡∏°‡πà
                    setTimeout(() => {
                        const allNotifications = document.querySelectorAll('.notification-item');
                        const notificationsArray = Array.from(allNotifications).map(el => ({
                            id: el.dataset.id,
                            type: 'missions', // default
                            is_read: el.classList.contains('read'),
                            created_at: new Date().toISOString()
                        }));
                        updateNotificationStats(notificationsArray);
                    }, 100);
                    
                    console.log(`‚úÖ ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô ID: ${notificationId} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`);
                    
                } catch (error) {
                    console.error('Error deleting notification:', error);
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô helper
            function getTypeLabel(type) {
                switch(type) {
                    case 'missions': return '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à';
                    case 'rewards': return '‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•';
                    case 'achievements': return '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                    case 'system': return '‡∏£‡∏∞‡∏ö‡∏ö';
                    default: return type;
                }
            }

            function getTimeAgo(date) {
                const now = new Date();
                const seconds = Math.floor((now - date) / 1000);
                
                let interval = Math.floor(seconds / 31536000);
                if (interval >= 1) {
                    return `${interval} ‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
                }
                
                interval = Math.floor(seconds / 2592000);
                if (interval >= 1) {
                    return `${interval} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
                }
                
                interval = Math.floor(seconds / 86400);
                if (interval >= 1) {
                    return `${interval} ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
                }
                
                interval = Math.floor(seconds / 3600);
                if (interval >= 1) {
                    return `${interval} ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
                }
                
                interval = Math.floor(seconds / 60);
                if (interval >= 1) {
                    return `${interval} ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß`;
                }
                
                return '‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà';
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ event listeners
            function setupEventListeners() {
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        applyFilter();
                    });
                });
                
                // Search input
                const searchInput = document.getElementById('notification-search');
                if (searchInput) {
                    let searchTimeout;
                    searchInput.addEventListener('input', function() {
                        clearTimeout(searchTimeout);
                        searchTimeout = setTimeout(() => {
                            applyFilter();
                        }, 300);
                    });
                }
                
                // Sort select
                const sortSelect = document.getElementById('notification-sort');
                if (sortSelect) {
                    sortSelect.addEventListener('change', function() {
                        applyFilter();
                    });
                }
                
                // Refresh button
                const refreshBtn = document.getElementById('refresh-notifications-btn');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', async () => {
                        refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                        await fetchNotifications();
                        refreshBtn.innerHTML = '<i class="fas fa-redo-alt mr-1"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä';
                    });
                }
                
                // Load more button
                const loadMoreBtn = document.getElementById('load-more-btn');
                if (loadMoreBtn) {
                    loadMoreBtn.addEventListener('click', () => {
                        // ‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°
                        alert('‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏à‡∏∞‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ');
                    });
                }
                
                // Mark all as read button
                const markAllReadBtn = document.getElementById('mark-all-read-btn');
                if (markAllReadBtn) {
                    markAllReadBtn.addEventListener('click', () => {
                        const allNotifications = document.querySelectorAll('.notification-item');
                        allNotifications.forEach(element => {
                            if (element.classList.contains('unread')) {
                                const markReadBtn = element.querySelector('.mark-read-btn');
                                const icon = element.querySelector('.mark-read-btn i');
                                
                                element.classList.remove('unread');
                                element.classList.add('read');
                                
                                if (markReadBtn) {
                                    markReadBtn.classList.remove('text-blue-600', 'hover:text-blue-800');
                                    markReadBtn.classList.add('text-gray-400');
                                }
                                
                                if (icon) {
                                    icon.className = 'fas fa-envelope-open';
                                }
                            }
                        });
                        
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
                        setTimeout(() => {
                            const allNotifications = document.querySelectorAll('.notification-item');
                            const notificationsArray = Array.from(allNotifications).map(el => ({
                                id: el.dataset.id,
                                type: 'missions',
                                is_read: true,
                                created_at: new Date().toISOString()
                            }));
                            updateNotificationStats(notificationsArray);
                        }, 100);
                        
                        alert('‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ß‡πà‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    });
                }
                
                // Clear all notifications button
                const clearAllBtn = document.getElementById('clear-notifications-btn');
                if (clearAllBtn) {
                    clearAllBtn.addEventListener('click', () => {
                        if (!confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                            return;
                        }
                        
                        const notificationsList = document.getElementById('notifications-list');
                        if (notificationsList) {
                            notificationsList.innerHTML = `
                                <div class="text-center py-8 text-gray-400">
                                    <i class="fas fa-bell-slash text-3xl mb-3"></i>
                                    <p>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
                                    <p class="text-sm mt-1">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                                </div>
                            `;
                        }
                        
                        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏õ‡πá‡∏ô 0
                        const elements = {
                            'unread-count': 0,
                            'stats-total': 0,
                            'stats-unread': 0,
                            'stats-read': 0,
                            'stats-missions': 0,
                            'stats-rewards': 0
                        };
                        
                        for (const [id, value] of Object.entries(elements)) {
                            const element = document.getElementById(id);
                            if (element) {
                                element.textContent = value;
                            }
                        }
                        
                        alert('‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    });
                }
                
                // Save settings button
                const saveSettingsBtn = document.getElementById('save-settings-btn');
                if (saveSettingsBtn) {
                    saveSettingsBtn.addEventListener('click', () => {
                        alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!');
                    });
                }
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏£‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            function applyFilter() {
                const activeFilter = document.querySelector('.filter-btn.active')?.dataset.filter || 'all';
                const searchQuery = document.getElementById('notification-search')?.value.toLowerCase() || '';
                const sortOption = document.getElementById('notification-sort')?.value || 'newest';
                
                const allNotifications = document.querySelectorAll('.notification-item');
                
                allNotifications.forEach(element => {
                    let showElement = true;
                    
                    // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
                    if (activeFilter !== 'all') {
                        const typeElement = element.querySelector('span:last-child');
                        const typeText = typeElement ? typeElement.textContent.trim() : '';
                        
                        if (activeFilter === 'unread') {
                            showElement = element.classList.contains('unread');
                        } else {
                            const typeMap = {
                                'missions': '‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à',
                                'rewards': '‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•',
                                'achievements': '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                                'system': '‡∏£‡∏∞‡∏ö‡∏ö'
                            };
                            
                            const expectedType = typeMap[activeFilter];
                            showElement = typeText === expectedType;
                        }
                    }
                    
                    // ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    if (showElement && searchQuery) {
                        const title = element.querySelector('h3')?.textContent.toLowerCase() || '';
                        const message = element.querySelector('p')?.textContent.toLowerCase() || '';
                        
                        if (!title.includes(searchQuery) && !message.includes(searchQuery)) {
                            showElement = false;
                        }
                    }
                    
                    // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô element
                    if (showElement) {
                        element.style.display = 'block';
                    } else {
                        element.style.display = 'none';
                    }
                });
                
                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö (‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á)
                console.log(`‡∏Å‡∏£‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢: ${activeFilter}, ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ${searchQuery}, ‡πÄ‡∏£‡∏µ‡∏¢‡∏á: ${sortOption}`);
            }

            // ‡∏£‡∏≠‡πÉ‡∏´‡πâ auth_status_manager ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏£‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ auth system ‡∏û‡∏£‡πâ‡∏≠‡∏°
            setTimeout(() => {
                fetchNotifications();
                setupEventListeners();
            }, 1000);
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ auth
            // (‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö missions.html)
            if (window.supabaseClient) {
                window.supabaseClient.auth.onAuthStateChange((event, session) => {
                    console.log(`Auth state changed: ${event}`);
                    if (event === 'SIGNED_IN') {
                        // ‡∏´‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà ‡πÉ‡∏´‡πâ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        setTimeout(() => {
                            fetchNotifications();
                        }, 500);
                    }
                });
            }
        });
    </script>
</body>
</html>